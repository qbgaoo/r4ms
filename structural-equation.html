<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>26&nbsp; Structural equation model – R for Medical Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./multilevel-model.html" rel="next">
<link href="./canonical-correlation.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advanced-stat.html">Advanced methods</a></li><li class="breadcrumb-item"><a href="./structural-equation.html"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Structural equation model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Medical Statistics</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://qbgaoo.github.io/r4ms" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./basic-stat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quat-data-statdesc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Statistical description of quantitative data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistical-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Statistical inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypothesis-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hypothesis test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count-data-statdesc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistical description of count data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete-data-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distributions of discrete variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-square-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Chi-square test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonparametric-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Bivariate regression and correlation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./advanced-stat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multifactor-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multifactor ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Repeated measures ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./general-linear-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">General linear model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate-groups-diff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multivariate data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Multiple linear regression analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Logistic regression analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-linear-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Generalized linear model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Cluster analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discriminant-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Discriminant analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca-factor-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Principal components and factor analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./canonical-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Canonical correlation analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structural-equation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Structural equation model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multilevel-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multilevel model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-estimating-equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Generalized estimating equation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-anal-report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communication</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pilot-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">A case to analyze</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./memo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Memo for future programming</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#prerequisite" id="toc-prerequisite" class="nav-link active" data-scroll-target="#prerequisite"><span class="header-section-number">26.1</span> Prerequisite</a></li>
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview"><span class="header-section-number">26.2</span> Overview</a>
  <ul class="collapse">
  <li><a href="#confirmatory-factor-analysis" id="toc-confirmatory-factor-analysis" class="nav-link" data-scroll-target="#confirmatory-factor-analysis"><span class="header-section-number">26.2.1</span> Confirmatory factor analysis</a></li>
  <li><a href="#components-of-sem" id="toc-components-of-sem" class="nav-link" data-scroll-target="#components-of-sem"><span class="header-section-number">26.2.2</span> Components of SEM</a></li>
  </ul></li>
  <li><a href="#evaluation-of-construct-validity" id="toc-evaluation-of-construct-validity" class="nav-link" data-scroll-target="#evaluation-of-construct-validity"><span class="header-section-number">26.3</span> Evaluation of construct validity</a></li>
  <li><a href="#sem-analysis" id="toc-sem-analysis" class="nav-link" data-scroll-target="#sem-analysis"><span class="header-section-number">26.4</span> SEM analysis</a>
  <ul class="collapse">
  <li><a href="#simple-sem" id="toc-simple-sem" class="nav-link" data-scroll-target="#simple-sem"><span class="header-section-number">26.4.1</span> Simple SEM</a></li>
  <li><a href="#complete-sem" id="toc-complete-sem" class="nav-link" data-scroll-target="#complete-sem"><span class="header-section-number">26.4.2</span> Complete SEM</a></li>
  </ul></li>
  <li><a href="#issues-need-consideration" id="toc-issues-need-consideration" class="nav-link" data-scroll-target="#issues-need-consideration"><span class="header-section-number">26.5</span> Issues need consideration</a>
  <ul class="collapse">
  <li><a href="#theoretical-foundation" id="toc-theoretical-foundation" class="nav-link" data-scroll-target="#theoretical-foundation"><span class="header-section-number">26.5.1</span> Theoretical foundation</a></li>
  <li><a href="#model-identifiability" id="toc-model-identifiability" class="nav-link" data-scroll-target="#model-identifiability"><span class="header-section-number">26.5.2</span> Model identifiability</a></li>
  <li><a href="#sample-size" id="toc-sample-size" class="nav-link" data-scroll-target="#sample-size"><span class="header-section-number">26.5.3</span> Sample size</a></li>
  <li><a href="#data-characteristics" id="toc-data-characteristics" class="nav-link" data-scroll-target="#data-characteristics"><span class="header-section-number">26.5.4</span> Data characteristics</a></li>
  <li><a href="#path-coefficients" id="toc-path-coefficients" class="nav-link" data-scroll-target="#path-coefficients"><span class="header-section-number">26.5.5</span> Path coefficients</a></li>
  <li><a href="#model-modification" id="toc-model-modification" class="nav-link" data-scroll-target="#model-modification"><span class="header-section-number">26.5.6</span> Model modification</a></li>
  <li><a href="#types-of-effects" id="toc-types-of-effects" class="nav-link" data-scroll-target="#types-of-effects"><span class="header-section-number">26.5.7</span> Types of effects</a></li>
  <li><a href="#model-interpretability" id="toc-model-interpretability" class="nav-link" data-scroll-target="#model-interpretability"><span class="header-section-number">26.5.8</span> Model interpretability</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://qbgaoo.github.io/r4ms/edit/main/structural-equation.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://qbgaoo.github.io/r4ms/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advanced-stat.html">Advanced methods</a></li><li class="breadcrumb-item"><a href="./structural-equation.html"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Structural equation model</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-structural-equation" class="quarto-section-identifier"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Structural equation model</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Structural equation modeling (SEM) is a statistical technique that allows for the estimation of complex relationships between observed and latent variables. SEM combines the strengths of path analysis, confirmatory factor analysis (CFA), and regression analysis, allowing for the simultaneous handling of measurement errors, latent variables, and observed variables. It enables us to test complex causal relationships. The SEM introduced in this chapter is primarily used for CFA. CFA is widely used in fields like psychology, education, and social sciences to validate theoretical constructs and measurement instruments.</p>
<section id="prerequisite" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="prerequisite"><span class="header-section-number">26.1</span> Prerequisite</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="overview" class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="overview"><span class="header-section-number">26.2</span> Overview</h2>
<section id="confirmatory-factor-analysis" class="level3" data-number="26.2.1">
<h3 data-number="26.2.1" class="anchored" data-anchor-id="confirmatory-factor-analysis"><span class="header-section-number">26.2.1</span> Confirmatory factor analysis</h3>
<p>Confirmatory factor analysis (CFA) is often used to test whether a hypothesized factor structure fits the observed data. Unlike exploratory factor analysis (EFA, see <a href="pca-factor-analysis.html#sec-factor-analysis" class="quarto-xref"><span>Section 24.3.1</span></a> ), which is used to discover the underlying structure of data without predefined assumptions, CFA is applied when researchers have specific theories or models about the relationships between observed variables and their underlying latent factors. It is frequently used in scale design for estimating parameters and assessing the model’s goodness-of-fit, <a href="#ex26-01">Example 1</a> is an scale for stroke patient-reported outcome measure. Based on this example, the readers can better understand the concepts and principles of CFA and SEM.</p>
<div id="ex26-01" class="example">
<strong>Example 1:</strong> 
<p>A group utilized the stroke patient-reported outcome measure (hereafter referred to as Stroke-PROM) to survey 295 stroke patients in order to assess their treatment outcomes. The Stroke-PROM includes four dimensions with 20 items in the physiological domain, three dimensions with 14 items in the psychological domain, two dimensions with 7 items in the social domain, and one dimension with 5 items in the treatment domain. The structure of Stroke-PROM is shown in <a href="#tbl-stroke-prom" class="quarto-xref">Table&nbsp;<span>26.1</span></a> .</p>
</div>
<div class="cell">
<div id="tbl-stroke-prom" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-stroke-prom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;26.1: Brief description of Stroke-PROM structure
</figcaption>
<div aria-describedby="tbl-stroke-prom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 11%">
<col style="width: 20%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Domain</th>
<th style="text-align: left;">Dimension</th>
<th style="text-align: center;">Variable</th>
<th style="text-align: center;">Number_of_Items</th>
<th style="text-align: left;">Items_Included</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Physiological domain</td>
<td style="text-align: left;">Somatic symptoms</td>
<td style="text-align: center;">SOS</td>
<td style="text-align: center;">7</td>
<td style="text-align: left;">PHD1 ~ PHD7</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Cognitive ability</td>
<td style="text-align: center;">COG</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">PHD8 ~ PHD11</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Verbal communication</td>
<td style="text-align: center;">VEC</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">PHD12 ~ PHD15</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Self-help skill</td>
<td style="text-align: center;">SHS</td>
<td style="text-align: center;">5</td>
<td style="text-align: left;">PHD16 ~ PHD20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Psychological domain</td>
<td style="text-align: left;">Anxiety</td>
<td style="text-align: center;">ANX</td>
<td style="text-align: center;">5</td>
<td style="text-align: left;">PSD1 ~ PSD5</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Depression</td>
<td style="text-align: center;">DEP</td>
<td style="text-align: center;">5</td>
<td style="text-align: left;">PSD6 ~ PSD10</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Avoidance</td>
<td style="text-align: center;">AVO</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">PSD11 ~ PSD14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Social domain</td>
<td style="text-align: left;">Social contact</td>
<td style="text-align: center;">SOC</td>
<td style="text-align: center;">3</td>
<td style="text-align: left;">SOR1 ~ SOR3</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Family support</td>
<td style="text-align: center;">FAS</td>
<td style="text-align: center;">4</td>
<td style="text-align: left;">SOR4 ~ SOR7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Treatment domain</td>
<td style="text-align: left;">Satisfaction</td>
<td style="text-align: center;">SAT</td>
<td style="text-align: center;">5</td>
<td style="text-align: left;">THA1 ~ THA5</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section>
<section id="components-of-sem" class="level3" data-number="26.2.2">
<h3 data-number="26.2.2" class="anchored" data-anchor-id="components-of-sem"><span class="header-section-number">26.2.2</span> Components of SEM</h3>
<p>The structure of a SEM consists of several key components:</p>
<p><strong>Observed variables</strong></p>
<p>Observed variables, also known as manifest variables, these are the variables that are directly measured in a study. They are the actual data collected from participants or experiments. For example, in <a href="#tbl-stroke-prom" class="quarto-xref">Table&nbsp;<span>26.1</span></a> , items or questions that participants respond to are observed variables because they are directly measured.</p>
<p><strong>Latent variables</strong></p>
<p>Latent variables are variables that are not directly measured but are inferred from observed variables. Latent variables represent underlying constructs or factors that are assumed to influence the observed variables. In <a href="#tbl-stroke-prom" class="quarto-xref">Table&nbsp;<span>26.1</span></a> , examples of latent variables include psychological traits like anxiety, depression, or avoidance, which cannot be measured directly but can be inferred through a set of observed vairables.</p>
<p><strong>Exogenous variables</strong></p>
<p>Exogenous variables are the independent variables in the model. They are not explained by any other variables within the model and are used to explain the variation in the endogenous variables. Exogenous variables are typically assumed to be external to the model.</p>
<p><strong>Endogenous variables</strong></p>
<p>Endogenous variables are the dependent variables in the model that are explained by other variables. They are influenced by both exogenous variables and other endogenous variables. In SEM, endogenous variables can be either latent or observed variables.</p>
<p><strong>Measurement model</strong></p>
<p>The measurement model describes the relationships between latent variables and observed variables. It is typically estimated using CFA. For each latent variable <span class="math inline">\boldsymbol \eta</span> and its corresponding observed variables <span class="math inline">\mathbf y</span>, the measurement model can be expressed as:</p>
<p><span class="math display">
\mathbf y = \boldsymbol \Lambda_\mathbf y \boldsymbol \eta ​+ \boldsymbol \epsilon
</span></p>
<p>where <span class="math inline">\mathbf y</span> is a vector of all observed variables, <span class="math inline">\boldsymbol \eta</span> is a vector of all latent variables. <span class="math inline">\boldsymbol \Lambda_\mathbf y</span> ​is the factor loadings matrix, representing the strength of the relationship between each observed variable and its corresponding latent variable, and <span class="math inline">\boldsymbol \epsilon</span> is the measurement error vector, representing the portion of each observed variable that is not explained by the latent variable.</p>
<p><strong>Structural model</strong></p>
<p>The structural model describes the causal relationships among latent variables. It is similar to path analysis but can include more complex causal relationships, such as direct effects, indirect effects, and mediating effects. The structural model can be expressed as:</p>
<p><span class="math display">
\boldsymbol \eta = \mathbf B \boldsymbol \eta + \boldsymbol \Gamma \boldsymbol \xi + \boldsymbol \zeta
</span></p>
<p>where <span class="math inline">\boldsymbol \eta</span> is a vector of endogenous latent variables , <span class="math inline">\boldsymbol \xi</span> is a vector of exogenous latent variables, <span class="math inline">\mathbf B</span> is the path coefficients matrix, representing the causal relationships among endogenous latent variables, <span class="math inline">\boldsymbol \Gamma</span> is the effects matrix, representing the influence of exogenous latent variables on endogenous latent variables, <span class="math inline">\boldsymbol \zeta</span> is the residual vector, representing the portion of the endogenous latent variables that is not explained by the model.</p>
<p>Combining the measurement model and the structural model, we get the complete SEM model. Suppose we have <span class="math inline">p</span> observed variables and <span class="math inline">q</span> latent variables, where <span class="math inline">m</span> are endogenous latent variables and <span class="math inline">n</span> are exogenous latent variables. The combined model can be expressed as:</p>
<p><span class="math display">
\left\{
\begin{array}{l}
\mathbf y = \boldsymbol \Lambda_y \boldsymbol \eta + \boldsymbol \epsilon \\
\mathbf x = \boldsymbol \Lambda_x \boldsymbol \xi + \boldsymbol \delta \\
\boldsymbol \eta = \mathbf B \boldsymbol \eta + \boldsymbol \Gamma \boldsymbol \xi + \boldsymbol \zeta
\end{array}
\right.
</span>​</p>
<p>where <span class="math inline">\mathbf y</span> is a vector of endogenous observed variables, <span class="math inline">\mathbf x</span> is a vector of exogenous observed variables, <span class="math inline">\boldsymbol \Lambda_\mathbf y</span> is the factor loadings matrix for endogenous observed variables, <span class="math inline">\boldsymbol \Lambda_\mathbf x</span> is the factor loadings matrix for exogenous observed variables, <span class="math inline">\boldsymbol \epsilon</span> is the measurement error vector for endogenous observed variables, <span class="math inline">\boldsymbol \delta</span> is the measurement error vector for exogenous observed variables, <span class="math inline">\boldsymbol \eta</span> is a vector of endogenous latent variables, <span class="math inline">\boldsymbol \xi</span> is a vector of exogenous latent variables, <span class="math inline">\mathbf B</span> is the path coefficients matrix for endogenous latent variables, <span class="math inline">\boldsymbol \Gamma</span> is the effects matrix for the influence of exogenous latent variables on endogenous latent variables, <span class="math inline">\boldsymbol \zeta</span> is the residual vector for endogenous latent variables.</p>
<div>
<p><a href="datasets/ex26-01.csv" download="ex26-01.csv" class="btn btn-success"> <i class="bi bi-database-fill-down"></i> Download data </a></p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/ex26-01.csv"</span>, <span class="at">show_col_types =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>m_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="st">  SOS =~ PHD1 + PHD2 + PHD3 + PHD4 + PHD5 + PHD6 + PHD7</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX =~ PSD1 + PSD2 + PSD3 + PSD4 + PSD5</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>s_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX ~ SOS</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">c</span>(m_model, s_model)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>res.cfa <span class="ot">&lt;-</span> <span class="fu">cfa</span>(m_model, df)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>res.sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(full_model, df)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  res.sem, <span class="at">what =</span> <span class="st">"std"</span>, <span class="at">residuals =</span> T, <span class="at">rotation =</span> <span class="dv">2</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">fade =</span> F, <span class="at">layout =</span> <span class="st">"tree"</span>, <span class="at">intercepts =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="structural-equation_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>m_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="st">  SOS =~ PHD1 + PHD2 + PHD3 + PHD4 + PHD5 + PHD6 + PHD7</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="st">  COG =~ PHD8 + PHD9 + PHD10 + PHD11</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="st">  VEC =~ PHD12 + PHD13 + PHD14 + PHD15</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SHS =~ PHD16 + PHD17 + PHD18 + PHD19 + PHD20</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX =~ PSD1 + PSD2 + PSD3 + PSD4 + PSD5</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="st">  DEP =~ PSD6 + PSD7 + PSD8 + PSD9 + PSD10</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="st">  AVO =~ PSD11 + PSD12 + PSD13 + PSD14</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>s_model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX ~ SOS</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>full_model <span class="ot">&lt;-</span> <span class="fu">c</span>(m_model, s_model)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>res.cfa <span class="ot">&lt;-</span> <span class="fu">cfa</span>(m_model, df)</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>res.sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(full_model, df)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(res.cfa, <span class="st">"std"</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>, <span class="at">fade =</span> F)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(res.sem, <span class="at">what =</span> <span class="st">"std"</span>, <span class="at">residuals =</span> T, <span class="at">rotation =</span> <span class="dv">2</span>, <span class="at">edge.label.cex =</span> <span class="fl">0.8</span>,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">fade =</span> F, <span class="at">layout =</span> <span class="st">"tree"</span>, <span class="at">intercepts =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="structural-equation_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="structural-equation_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define a theoretical SEM model</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="st">  xi1 =~ X1 + X2 + X3</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="st">  xi2 =~ X4 + X5 + X6</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="st">  eta1 =~ Y1 + Y2</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="st">  eta2 =~ Y3 + Y4</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural relationships</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="st">  eta1 ~ xi1 + xi2</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="st">  eta2 ~ eta1 + xi2</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="st">  xi1 ~~ xi2</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="st">  eta1 ~~ eta2</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="evaluation-of-construct-validity" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="evaluation-of-construct-validity"><span class="header-section-number">26.3</span> Evaluation of construct validity</h2>
<p>CFA is essentially a measurement model within SEM and is often used to assess the construct validity of a measure or scale, ensuring its accuracy in measuring the intended constructs.</p>
<p>The key steps involved in CFA are as follows:</p>
<ol type="1">
<li>Model specification: Based on existing theory or hypotheses, the relationships between latent variables and observed variables are defined.</li>
<li>Parameter estimation: Statistical methods (such as maximum likelihood estimation) are used to estimate the parameters of the model, determining the associations between latent and observed variables.</li>
<li>Model evaluation: Various fit indices (e.g., Chi-square test, CFI, TLI, RMSEA) are used to evaluate whether the model fits the data well.</li>
<li>Model modification: Based on the evaluation results, adjustments may be made to improve the model’s fit.</li>
<li>Interpretation of results: The path coefficients and relationships between latent variables are analyzed to interpret the measurement results.</li>
</ol>
<div class="example">
<strong>Example 2:</strong> 
<p>Use CFA to evaluate the construct validity of the Stroke-PROM scale in the physiological domain, i.e.&nbsp;SOS, COG, VEC, and SHS. This domain consists of four dimensions, corresponding to four latent factors. R software was used for modeling, the maximum likelihood estimation method was used to assess the construct validity of the different dimensions of the scale.</p>
</div>
<div>
<p><a href="datasets/ex26-02.csv" download="ex26-02.csv" class="btn btn-success"> <i class="bi bi-database-fill-down"></i> Download data </a></p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/ex26-02.csv"</span>, <span class="at">show_col_types =</span> F) </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ordered</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; ordered()
#&gt; Levels:</code></pre>
</div>
</div>
<p>The Stroke-PROM scale in the physiological domain includes four latent variables, i.e.&nbsp;SOS, COG, VEC, and SHS. Each latent variable is measured by multiple observed variables (i.e., the individual items or questions in the scale).</p>
<p>Using the <code>lavaan</code> package, you can define and evaluate the model. First, define the relationships between the latent variables and their observed variables. Then use the <code>cfa()</code> function to fit the model use your data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">  SOS =~ PHD1 + PHD2 + PHD3 + PHD4 + PHD5 + PHD6 + PHD7</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">  COG =~ PHD8 + PHD9 + PHD10 + PHD11</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">  VEC =~ PHD12 + PHD13 + PHD14 + PHD15</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">  SHS =~ PHD16 + PHD17 + PHD18 + PHD19 + PHD20</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>fit.cfa <span class="ot">&lt;-</span> <span class="fu">cfa</span>(model, <span class="at">data =</span> df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Assess the goodness-of-fit using indices such as:</p>
<ul>
<li>Chi-square test: A significant value suggests a misfit, but it’s sensitive to large sample sizes.</li>
<li>CFI (comparative fit index): Values &gt; 0.90 or 0.95 indicate a good fit.</li>
<li>TLI (Tucker-Lewis index): Values &gt; 0.90 or 0.95 are desirable.</li>
<li>RMSEA (root mean square error of approximation): Values &lt; 0.08 indicate acceptable fit; &lt; 0.05 indicates a good fit.</li>
<li>SRMR (standardized root mean square residual): Values &lt; 0.08 are considered acceptable.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>fit.cfa <span class="sc">|&gt;</span> <span class="fu">fitMeasures</span>(<span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"cfi"</span>, <span class="st">"tli"</span>, <span class="st">"rmsea"</span>, <span class="st">"srmr"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;   chisq     cfi     tli   rmsea    srmr 
#&gt; 630.894   0.867   0.846   0.098   0.082</code></pre>
</div>
</div>
<p>Check if each observed variable loads significantly on its corresponding latent factor.</p>
<div class="cell">
<div class="sourceCode cell-code" id="annotated-cell-9"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="1">1</button><span id="annotated-cell-9-1" class="code-annotation-target"><a href="#annotated-cell-9-1" aria-hidden="true" tabindex="-1"></a>fit.cfa <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">standardized =</span> T, <span class="at">rsquare =</span> T)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-9" data-target-annotation="2">2</button><span id="annotated-cell-9-2" class="code-annotation-target"><a href="#annotated-cell-9-2" aria-hidden="true" tabindex="-1"></a>fit.cfa <span class="sc">|&gt;</span> <span class="fu">standardizedSolution</span>(<span class="at">output =</span> <span class="st">"text"</span>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-9" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="1" data-code-annotation="1">Note that <em>SE</em>s and tests are still based on unstandardized estimates.</span>
</dd>
<dt data-target-cell="annotated-cell-9" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-9" data-code-lines="2" data-code-annotation="2">Use <code>standardizedSolution()</code> to obtain <em>SE</em>s and test statistics for standardized estimates.</span>
</dd>
</dl>
</div>
</div>
<p>Visualize the relationships between latent and observed variables using <code>semPaths(</code>) function from <code>semPlot</code> package:</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="structural-equation_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="816"></p>
</figure>
</div>
</div>
</div>
<p>If the model fit is not adequate, consider modifying the model based on the modification indices, which suggest potential areas for improvement:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>fit.cfa <span class="sc">|&gt;</span> <span class="fu">modindices</span>(<span class="at">sort. =</span> T, <span class="at">power =</span> T, <span class="at">maximum.number =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;       lhs op   rhs     mi    epc sepc.all delta   ncp power decision
#&gt; 280 PHD14 ~~ PHD15 84.094  0.428    0.612   0.1 4.583 0.572  **(m)**
#&gt; 291 PHD16 ~~ PHD17 76.363  0.402    0.600   0.1 4.720 0.584  **(m)**
#&gt; 265 PHD12 ~~ PHD13 52.654  0.472    0.559   0.1 2.368 0.337  **(m)**
#&gt; 181  PHD5 ~~  PHD6 51.566  0.305    0.740   0.1 5.547 0.654  **(m)**
#&gt; 91    VEC =~ PHD16 33.919  0.480    0.343   0.1 1.471 0.228  **(m)**
#&gt; 111  PHD1 ~~  PHD2 29.218  0.478    0.328   0.1 1.277 0.204  **(m)**
#&gt; 266 PHD12 ~~ PHD14 22.832 -0.261   -0.330   0.1 3.350 0.448  **(m)**
#&gt; 90    VEC =~ PHD11 22.010  0.602    0.479   0.1 0.607 0.122  **(m)**
#&gt; 286 PHD15 ~~ PHD16 21.051  0.231    0.291   0.1 3.937 0.510  **(m)**
#&gt; 75    COG =~ PHD16 20.641  0.314    0.209   0.1 2.091 0.304  **(m)**</code></pre>
</div>
</div>
<p>By conducting CFA on the Stroke-PROM scale, you can determine whether the physiological domain’s structure, consisting of SOS, COG, VEC, and SHS, demonstrates construct validity.</p>
</section>
<section id="sem-analysis" class="level2" data-number="26.4">
<h2 data-number="26.4" class="anchored" data-anchor-id="sem-analysis"><span class="header-section-number">26.4</span> SEM analysis</h2>
<section id="simple-sem" class="level3" data-number="26.4.1">
<h3 data-number="26.4.1" class="anchored" data-anchor-id="simple-sem"><span class="header-section-number">26.4.1</span> Simple SEM</h3>
<div class="example">
<strong>Example 3:</strong> 
<p>Construct a structural equation model using the somatic symptoms (SOS) from the physiological domain and anxiety (ANX) from the psychological domain of the Stroke-PROM scale. The model includes only one exogenous latent variable and one endogenous latent variable.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/ex26-03.csv"</span>, <span class="at">show_col_types =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SOS =~ PHD1 + PHD2 + PHD3 + PHD4 + PHD5 + PHD6 + PHD7</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX =~ PSD1 + PSD2 + PSD3 + PSD4 + PSD5</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural relationships</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX ~ SOS</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>fit.sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>fit.sem <span class="sc">|&gt;</span> <span class="fu">summary</span>(<span class="at">standardized =</span> T, <span class="at">rsquare =</span> T) </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fit.sem <span class="sc">|&gt;</span> <span class="fu">standardizedSolution</span>(<span class="at">output =</span> <span class="st">"text"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>res.sem <span class="sc">|&gt;</span> <span class="fu">fitMeasures</span>(<span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"rmsea"</span>, <span class="st">"aic"</span>, <span class="st">"gfi"</span>, <span class="st">"cfi"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;     chisq     rmsea       aic       gfi       cfi 
#&gt;  1472.818     0.080 27602.396     0.766     0.856</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fit.sem <span class="sc">|&gt;</span> <span class="fu">semPaths</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">what =</span> <span class="st">"std"</span>, <span class="at">style =</span> <span class="st">"lisrel"</span>, <span class="at">residuals =</span> T, <span class="at">edge.label.cex =</span> <span class="fl">0.6</span>, </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fade =</span> F, <span class="at">layout =</span> <span class="st">"tree"</span>, <span class="at">intercepts =</span> T, <span class="at">rotation =</span> <span class="dv">1</span>,</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizeMan =</span> <span class="dv">3</span>, <span class="at">sizeLat =</span> <span class="dv">8</span>, <span class="at">sizeLat2 =</span> <span class="dv">6</span>, <span class="at">residScale =</span> <span class="dv">6</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="structural-equation_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fit.sem <span class="sc">|&gt;</span> <span class="fu">modindices</span>(<span class="at">sort. =</span> T, <span class="at">power =</span> T, <span class="at">maximum.number =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;      lhs op  rhs     mi    epc sepc.all delta   ncp power decision
#&gt; 78  PHD5 ~~ PHD6 60.918  0.346    0.823   0.1 5.090 0.616  **(m)**
#&gt; 40  PHD1 ~~ PHD2 28.090  0.467    0.323   0.1 1.289 0.206  **(m)**
#&gt; 96  PSD1 ~~ PSD2 23.615  0.250    0.338   0.1 3.776 0.493  **(m)**
#&gt; 105 PSD4 ~~ PSD5 17.261  0.199    0.362   0.1 4.366 0.552  **(m)**
#&gt; 43  PHD1 ~~ PHD5 13.183 -0.223   -0.261   0.1 2.652 0.370  **(m)**
#&gt; 62  PHD3 ~~ PHD5 11.768 -0.227   -0.246   0.1 2.287 0.327  **(m)**
#&gt; 79  PHD5 ~~ PHD7 11.438 -0.177   -0.252   0.1 3.632 0.478  **(m)**
#&gt; 101 PSD2 ~~ PSD4 10.212 -0.163   -0.222   0.1 3.827 0.499  **(m)**
#&gt; 54  PHD2 ~~ PHD6  9.938 -0.162   -0.228   0.1 3.795 0.495  **(m)**
#&gt; 38   ANX =~ PHD6  9.019 -0.204   -0.170   0.1 2.160 0.312  **(m)**</code></pre>
</div>
</div>
</section>
<section id="complete-sem" class="level3" data-number="26.4.2">
<h3 data-number="26.4.2" class="anchored" data-anchor-id="complete-sem"><span class="header-section-number">26.4.2</span> Complete SEM</h3>
<div class="example">
<strong>Example 4:</strong> 
<p>Construct a structural equation model using the somatic symptoms (SOS) from the physiological domain and anxiety (ANX) from the psychological domain of the Stroke-PROM scale. The model includes only one exogenous latent variable and one endogenous latent variable.</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/ex26-04.csv"</span>, <span class="at">show_col_types =</span> F) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="st">'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="st">  # Measurement model</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="st">  SOS =~ PHD1 + PHD2 + PHD3 + PHD4 + PHD5 + PHD6 + PHD7</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="st">  COG =~ PHD8 + PHD9 + PHD10 + PHD11</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX =~ PSD1 + PSD2 + PSD3 + PSD4 + PSD5</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="st">  DEP =~ PSD6 + PSD7 + PSD8 + PSD9 + PSD10</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="st">  AVO =~ PSD11 + PSD12 + PSD13 + PSD14</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="st">  # Structural relationships</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="st">  ANX ~ SOS</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="st">  DEP ~ COG</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="st">  DEP ~ AVO</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="st">  DEP ~ ANX</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="st">  AVO ~ COG</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="st">  AVO ~ ANX</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>res.sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(model, df)</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>res.sem</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; lavaan 0.6-19 ended normally after 41 iterations
#&gt; 
#&gt;   Estimator                                         ML
#&gt;   Optimization method                           NLMINB
#&gt;   Number of model parameters                        57
#&gt; 
#&gt;   Number of observations                           295
#&gt; 
#&gt; Model Test User Model:
#&gt;                                                       
#&gt;   Test statistic                               747.369
#&gt;   Degrees of freedom                               268
#&gt;   P-value (Chi-square)                           0.000</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>res.sem <span class="sc">|&gt;</span> <span class="fu">fitMeasures</span>(<span class="fu">c</span>(<span class="st">"chisq"</span>, <span class="st">"rmsea"</span>, <span class="st">"aic"</span>, <span class="st">"gfi"</span>, <span class="st">"cfi"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;     chisq     rmsea       aic       gfi       cfi 
#&gt;   747.369     0.078 20129.701     0.828     0.891</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>res.sem <span class="sc">|&gt;</span> <span class="fu">semPaths</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">what =</span> <span class="st">"std"</span>, <span class="at">style =</span> <span class="st">"lisrel"</span>, <span class="at">residuals =</span> T, <span class="at">edge.label.cex =</span> <span class="fl">0.6</span>, </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">fade =</span> F, <span class="at">layout =</span> <span class="st">"tree"</span>, <span class="at">intercepts =</span> T, <span class="at">rotation =</span> <span class="dv">1</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">sizeMan =</span> <span class="dv">3</span>, <span class="at">sizeLat =</span> <span class="dv">8</span>, <span class="at">sizeLat2 =</span> <span class="dv">6</span>, <span class="at">residScale =</span> <span class="dv">6</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="structural-equation_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="480"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>res.sem <span class="sc">|&gt;</span> <span class="fu">modindices</span>(<span class="at">sort. =</span> T, <span class="at">power =</span> T, <span class="at">maximum.number =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;       lhs op   rhs     mi    epc sepc.all delta    ncp power decision
#&gt; 457 PSD11 ~~ PSD12 81.374  0.369    1.141   0.1  5.966 0.685  **(m)**
#&gt; 253  PHD5 ~~  PHD6 60.698  0.319    0.727   0.1  5.961 0.685  **(m)**
#&gt; 113   ANX =~  PSD6 45.656  0.625    0.517   0.1  1.168 0.191  **(m)**
#&gt; 448  PSD9 ~~ PSD10 39.472  0.214    0.449   0.1  8.595 0.834  *epc:m*
#&gt; 430  PSD6 ~~ PSD10 30.656 -0.164   -0.414   0.1 11.420 0.922  *epc:m*
#&gt; 141   DEP =~ PSD14 30.594  0.837    0.587   0.1  0.437 0.101  **(m)**
#&gt; 163  PHD1 ~~  PHD2 27.556  0.460    0.320   0.1  1.305 0.208  **(m)**
#&gt; 372  PSD1 ~~  PSD2 25.430  0.256    0.338   0.1  3.875 0.503  **(m)**
#&gt; 459 PSD11 ~~ PSD14 21.826 -0.190   -0.393   0.1  6.020 0.689  **(m)**
#&gt; 462 PSD13 ~~ PSD14 16.927  0.203    0.272   0.1  4.107 0.527  **(m)**</code></pre>
</div>
</div>
<p>Here we write a function named <code>extract_sem_eq()</code>, to directly extract the measurement model and the structural model from the structural equation model, and format it into a readable equation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>extract_sem_eq <span class="ot">&lt;-</span> <span class="cf">function</span>(object, <span class="at">std =</span> <span class="cn">TRUE</span>, <span class="at">digits =</span> <span class="dv">2</span>) {</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extract parameter estimates</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  params <span class="ot">&lt;-</span> <span class="fu">parameterEstimates</span>(object, <span class="at">standardized =</span> std)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter for measurement model (latent =~ observed)</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  m_model <span class="ot">&lt;-</span> params[params<span class="sc">$</span>op <span class="sc">==</span> <span class="st">"=~"</span>, ]</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter for structural model (latent ~ latent or observed ~ latent)</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  s_model <span class="ot">&lt;-</span> params[params<span class="sc">$</span>op <span class="sc">==</span> <span class="st">"~"</span>, ]</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate measurement model equations</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Measurement Model Equations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (lhs_var <span class="cf">in</span> <span class="fu">unique</span>(m_model<span class="sc">$</span>lhs)) {</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get all rows corresponding to the lhs variable (latent variable)</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>    eq_rows <span class="ot">&lt;-</span> m_model[m_model<span class="sc">$</span>lhs <span class="sc">==</span> lhs_var, ]</span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the equation for this latent variable</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a>    equation <span class="ot">&lt;-</span> <span class="fu">paste0</span>(lhs_var, <span class="st">" = "</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over each observed variable (rhs) and its coefficient</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(eq_rows)) {</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>      rhs_var <span class="ot">&lt;-</span> eq_rows<span class="sc">$</span>rhs[i]</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>      coef <span class="ot">&lt;-</span> <span class="fu">round</span>(eq_rows<span class="sc">$</span>std.all[i], digits)</span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add the term to the equation</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>      equation <span class="ot">&lt;-</span> <span class="fu">paste0</span>(equation, coef, <span class="st">" "</span>, rhs_var)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add a plus sign if not the last term</span></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">&lt;</span> <span class="fu">nrow</span>(eq_rows)) {</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>        equation <span class="ot">&lt;-</span> <span class="fu">paste0</span>(equation, <span class="st">" + "</span>)</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Output the equation</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(equation, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate structural model equations</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"</span><span class="sc">\n</span><span class="st">Structural Model Equations:</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (lhs_var <span class="cf">in</span> <span class="fu">unique</span>(s_model<span class="sc">$</span>lhs)) {</span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get all rows corresponding to the lhs variable</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    eq_rows <span class="ot">&lt;-</span> s_model[s_model<span class="sc">$</span>lhs <span class="sc">==</span> lhs_var, ]</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create the equation for this lhs variable</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>    equation <span class="ot">&lt;-</span> <span class="fu">paste0</span>(lhs_var, <span class="st">" = "</span>)</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Loop over each predictor (rhs) and its coefficient</span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(eq_rows)) {</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>      rhs_var <span class="ot">&lt;-</span> eq_rows<span class="sc">$</span>rhs[i]</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>      coef <span class="ot">&lt;-</span> <span class="fu">round</span>(eq_rows<span class="sc">$</span>std.all[i], digits)</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add the term to the equation</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>      equation <span class="ot">&lt;-</span> <span class="fu">paste0</span>(equation, coef, <span class="st">" "</span>, rhs_var)</span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Add a plus sign if not the last term</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (i <span class="sc">&lt;</span> <span class="fu">nrow</span>(eq_rows)) {</span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>        equation <span class="ot">&lt;-</span> <span class="fu">paste0</span>(equation, <span class="st">" + "</span>)</span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Output the equation</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(equation, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>res.sem <span class="sc">|&gt;</span> <span class="fu">extract_sem_eq</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Measurement Model Equations:
#&gt; SOS = 0.47 PHD1 + 0.52 PHD2 + 0.47 PHD3 + 0.78 PHD4 + 0.82 PHD5 + 0.81 PHD6 + 0.59 PHD7 
#&gt; COG = 0.74 PHD8 + 0.82 PHD9 + 0.78 PHD10 + 0.58 PHD11 
#&gt; ANX = 0.71 PSD1 + 0.71 PSD2 + 0.83 PSD3 + 0.73 PSD4 + 0.85 PSD5 
#&gt; DEP = 0.77 PSD6 + 0.86 PSD7 + 0.76 PSD8 + 0.7 PSD9 + 0.85 PSD10 
#&gt; AVO = 0.88 PSD11 + 0.85 PSD12 + 0.73 PSD13 + 0.66 PSD14 
#&gt; 
#&gt; Structural Model Equations:
#&gt; ANX = 0.63 SOS 
#&gt; DEP = 0.25 COG + 0.44 AVO + 0.37 ANX 
#&gt; AVO = 0.33 COG + 0.56 ANX</code></pre>
</div>
</div>
</section>
</section>
<section id="issues-need-consideration" class="level2" data-number="26.5">
<h2 data-number="26.5" class="anchored" data-anchor-id="issues-need-consideration"><span class="header-section-number">26.5</span> Issues need consideration</h2>
<p>When applying SEM, several key issues must be considered to ensure the model’s validity, reliability, and interpretability:</p>
<section id="theoretical-foundation" class="level3" data-number="26.5.1">
<h3 data-number="26.5.1" class="anchored" data-anchor-id="theoretical-foundation"><span class="header-section-number">26.5.1</span> Theoretical foundation</h3>
<p>The strength SEM lies in testing complex theoretical hypothesis. Therefore, model construction must be supported by strong theoretical foundations, including relationships between latent and observed variables, as well as causal paths between latent variables. The causal relationships within the model should be logical and theoretically justified, avoiding meaningless or unexplained paths.</p>
</section>
<section id="model-identifiability" class="level3" data-number="26.5.2">
<h3 data-number="26.5.2" class="anchored" data-anchor-id="model-identifiability"><span class="header-section-number">26.5.2</span> Model identifiability</h3>
<p>The identifiability determines whether model parameters can be uniquely estimated. An identifiable model requires sufficient observed data to estimate all parameters. A general rule is to have enough observed variables (typically at least three to four) for each latent variable to ensure that the parameters are estimable.</p>
</section>
<section id="sample-size" class="level3" data-number="26.5.3">
<h3 data-number="26.5.3" class="anchored" data-anchor-id="sample-size"><span class="header-section-number">26.5.3</span> Sample size</h3>
<p>SEM is a complex statistical technique that generally requires a large sample size for robust results. Too small a sample size may lead to unstable models and biased parameter estimates. Relationship between sample size and model complexity: More complex models typically require larger sample sizes. A general guideline is to have at least 10–20 observations per free parameter.</p>
</section>
<section id="data-characteristics" class="level3" data-number="26.5.4">
<h3 data-number="26.5.4" class="anchored" data-anchor-id="data-characteristics"><span class="header-section-number">26.5.4</span> Data characteristics</h3>
<p>SEM typically assumes multivariate normality. If the data significantly deviate from normality, robust estimation methods or techniques like bootstrapping may be required. Missing data is a critical issue in SEM. Common approaches include full information maximum likelihood (FIML), mean imputation, or other missing data techniques. Proper handling of missing data is crucial to avoid biased results.</p>
</section>
<section id="path-coefficients" class="level3" data-number="26.5.5">
<h3 data-number="26.5.5" class="anchored" data-anchor-id="path-coefficients"><span class="header-section-number">26.5.5</span> Path coefficients</h3>
<p>Test whether the path coefficients in the model are statistically significant by examining the standard errors and p-values. Significant paths indicate meaningful relationships between latent variables. In the measurement model, ensure that the factor loadings are significant and of reasonable magnitude (typically between 0.4 and 0.7).</p>
</section>
<section id="model-modification" class="level3" data-number="26.5.6">
<h3 data-number="26.5.6" class="anchored" data-anchor-id="model-modification"><span class="header-section-number">26.5.6</span> Model modification</h3>
<p>Modification indices can suggest potential improvements to the model, but changes should be theory-driven. Overreliance on modification indices may lead to a model that deviates from the original theoretical framework. Be cautious when modifying the model by adding or removing paths, especially if they are not supported by theory, as this can lead to overfitting.</p>
</section>
<section id="types-of-effects" class="level3" data-number="26.5.7">
<h3 data-number="26.5.7" class="anchored" data-anchor-id="types-of-effects"><span class="header-section-number">26.5.7</span> Types of effects</h3>
<p>The concepts of direct effects, indirect effects, and total effects are key to understanding how variables influence one another within a model.</p>
<p><strong>Direct effect:</strong> The direct effect refers to the immediate impact of one variable on another without any intervening variables. It is represented by a single path (or arrow) in the model. For example, in a model where variable <span class="math inline">X</span> directly affects variable <span class="math inline">Y</span>, the direct effect is the influence of <span class="math inline">X</span> on <span class="math inline">Y</span> without any mediation. If <span class="math inline">X</span> directly affects <span class="math inline">Y</span>, the direct effect measures how much a change in stress levels immediately influences health outcomes.</p>
<p><strong>Indirect effect:</strong> The indirect effect occurs when the relationship between two variables is mediated by one or more intervening variables. This effect is calculated by multiplying the coefficients of the paths that link the two variables through the mediator(s). For instance, if <span class="math inline">X</span> affects <span class="math inline">M</span> (a mediator) and <span class="math inline">M</span>, in turn, affects <span class="math inline">Y</span>, the indirect effect is the product of the path coefficients from <span class="math inline">X</span> to <span class="math inline">M</span> and from <span class="math inline">M</span> to <span class="math inline">Y</span>.</p>
<p><strong>Total effect:</strong> The total effect is the sum of the direct and indirect effects. It represents the overall impact of one variable on another, including both the direct influence and any mediated (indirect) pathways. The total effect can be thought of as the complete influence of <span class="math inline">X</span> on <span class="math inline">Y</span>, accounting for all possible paths, whether direct or mediated.</p>
<p>Example: If <span class="math inline">X</span> (parental support) directly affects <span class="math inline">Y</span> (academic performance) and also indirectly affects <span class="math inline">Y</span> through <span class="math inline">M</span> (self-esteem), the total effect captures both the direct influence of parental support on academic performance and its indirect effect through self-esteem.</p>
</section>
<section id="model-interpretability" class="level3" data-number="26.5.8">
<h3 data-number="26.5.8" class="anchored" data-anchor-id="model-interpretability"><span class="header-section-number">26.5.8</span> Model interpretability</h3>
<p>SEM results can be complex, especially with many path coefficients. When interpreting the results, focus on the main effects and relationships while keeping the explanation concise and clear. Supplement quantitative findings with qualitative insights from the research context can improve the interpretation of SEM results.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/qbgaoo\.github\.io\/r4ms");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./canonical-correlation.html" class="pagination-link" aria-label="Canonical correlation analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Canonical correlation analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./multilevel-model.html" class="pagination-link" aria-label="Multilevel model">
        <span class="nav-page-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multilevel model</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://qbgaoo.github.io/r4ms/edit/main/structural-equation.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://qbgaoo.github.io/r4ms/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>