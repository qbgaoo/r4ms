[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "R for Medical Statistics",
    "section": "",
    "text": "Preface\nThis book is created by Quarto and R in RStudio IDE。Quarto is an open-source publishing system that integrates well with R, enabling users to create dynamic documents that combine text, code, and output (like tables and plots) in a single document. It supports R Markdown, allowing the execution of R code within documents and rendering outputs in various formats, such as HTML, PDF, and Word. Quarto is ideal for creating reproducible reports, presentations, and books, especially in academic and research settings where R is extensively used. You can also manage bibliographies, citations, and cross-references easily. Quarto is highly customizable, allowing users to create complex documents with ease, and is often used with GitHub Actions for continuous integration and automated publishing.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1 Prerequisites\nWe’ve made a few assumptions about what you already know to get the most out of this book. You should have some basic knowledge about medical statistics, and it’s helpful if you have some basic R programming experience already.\nYou need some things to run the code in this book: R, RStudio and some preinstalled R packages. Packages are the fundamental units of reproducible R code. They include reusable functions, documentation that describes how to use them, and sample data.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#prerequisites",
    "href": "intro.html#prerequisites",
    "title": "1  Introduction",
    "section": "",
    "text": "1.1.1 R\nTo download R, go to CRAN, the comprehensive R archive network, https://cloud.r-project.org. A new major version of R comes out once a year, and there are 2-3 minor releases each year. It’s a good idea to update regularly. Upgrading can be a bit of a hassle, especially for major versions that require you to re-install all your packages, but putting it off only makes it worse. We recommend R 4.4.1 or later for this book.\n\n\n1.1.2 RStudio\nRStudio is an integrated development environment, or IDE, for R programming, which you can download from https://posit.co/download/rstudio-desktop/. RStudio is updated a couple of times a year, and it will automatically let you know when a new version is out, so there’s no need to check back. It’s a good idea to upgrade regularly to take advantage of the latest and greatest features. For this book, make sure you have at least RStudio 2024.04.2.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#running-r-code",
    "href": "intro.html#running-r-code",
    "title": "1  Introduction",
    "section": "1.2 Running R code",
    "text": "1.2 Running R code\nThe previous section showed you several examples of running R code. The code in the book looks like this:\n\n1 + 2\n#&gt; [1] 3\n\nIf you run the same code in your local console, it will look like this:\n&gt; 1 + 2\n[1] 3\nThere are two main differences. In your console, you type after the &gt;, called the prompt; we don’t show the prompt in the book. In the book, the output is commented out with #&gt;; in your console, it appears directly after your code. These two differences mean that if you’re working with an electronic version of the book, you can easily copy code out of the book and paste it into the console.\nThroughout the book, we use a consistent set of conventions to refer to code:\n\nFunctions are displayed in a code font and followed by parentheses, like sum() or mean().\nOther R objects (such as data or function arguments) are in a code font, without parentheses, like flights or x.\nSometimes, to make it clear which package an object comes from, we’ll use the package name followed by two colons, like dplyr::mutate() or nycflights13::flights. This is also valid R code.\nTo improves readability, variable names and function names are named using snake case.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "intro.html#colophon",
    "href": "intro.html#colophon",
    "title": "1  Introduction",
    "section": "1.3 Colophon",
    "text": "1.3 Colophon\nThe book is written by Quarto, an online version of it is available at https://qbgaoo.github.io/r4ms/. It will continue to evolve in between reprints of the physical book. The source of the book is available at https://qbgaoo.github.io/r4ms/.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "quat-data-stat-desc.html",
    "href": "quat-data-stat-desc.html",
    "title": "2  Statistical description of quantitative data",
    "section": "",
    "text": "2.1 Prerequisites\nSetting up the required R packages.\nlibrary(tidyverse)",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical description of quantitative data</span>"
    ]
  },
  {
    "objectID": "quat-data-stat-desc.html#dataset-used-below",
    "href": "quat-data-stat-desc.html#dataset-used-below",
    "title": "2  Statistical description of quantitative data",
    "section": "2.2 Dataset used below",
    "text": "2.2 Dataset used below\nIn this chapter, we use the Heart Failure Prediction Dataset refered as heart.csv in the context to demonstrate the issues. The file is downloaded and saved in the datasets folder of this project. You can import this file into R by read_csv() function. The first argument is the most important: the path to the file. You can think about the path as the address of the file.\n\nheart &lt;- read_csv(\"datasets/heart.csv\")\n#&gt; Rows: 918 Columns: 12\n#&gt; ── Column specification ─────────────────────────────────────────────────────\n#&gt; Delimiter: \",\"\n#&gt; chr (5): Sex, ChestPainType, RestingECG, ExerciseAngina, ST_Slope\n#&gt; dbl (7): Age, RestingBP, Cholesterol, FastingBS, MaxHR, Oldpeak, HeartDis...\n#&gt; \n#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.\n#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nThe code above will work if you have the heart.csv file in a datasets folder in your project. Here is a show of some data in the file.\n\nheart |&gt; \n  select(1:6)\n#&gt; # A tibble: 918 × 6\n#&gt;     Age Sex   ChestPainType RestingBP Cholesterol FastingBS\n#&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;             &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;\n#&gt; 1    40 M     ATA                 140         289         0\n#&gt; 2    49 F     NAP                 160         180         0\n#&gt; 3    37 M     ATA                 130         283         0\n#&gt; 4    48 F     ASY                 138         214         0\n#&gt; 5    54 M     NAP                 150         195         0\n#&gt; 6    39 M     NAP                 120         339         0\n#&gt; # ℹ 912 more rows\n\nOnce you read data in, the first step usually involves transforming it in some way to make it easier to work with in the rest of your analysis. Firstly, we use janitor::clean_names() to turn all column names of heart into snake case. Then a variable named max_hr (i.e. maximum heart rate) is selected for subsequent analysis.\n\nmax_hr &lt;- heart |&gt;\n  janitor::clean_names() |&gt; \n  select(max_hr, heart_disease) |&gt; \n  filter(heart_disease == 1) |&gt; \n  select(max_hr)\n\nnrow(max_hr)\n#&gt; [1] 508\n\nTotally there are 508 observations. The missing values are checked below：\n\nmax_hr |&gt; \n  anyNA()\n#&gt; [1] FALSE\n\nThe output FALSE indicates no missing values is present.",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical description of quantitative data</span>"
    ]
  },
  {
    "objectID": "quat-data-stat-desc.html#frequency-distribution",
    "href": "quat-data-stat-desc.html#frequency-distribution",
    "title": "2  Statistical description of quantitative data",
    "section": "2.3 Frequency distribution",
    "text": "2.3 Frequency distribution\n\n2.3.1 Frequency table\nA frequency table mentioned here is a statistical tool that organizes data into intervals and lists the number of frequency in each interval. It helps summarize large dataset by showing how often each value or range of values occurs, making it easier to identify trends and the overall distribution of the data. This table is often used in conjunction with visual tools like histogram to enhance data interpretation.\nHere is the steps for creating a frequency table for continuous variables.\n\nComputing the minimum and maximum of the variable.\n\n\nmin_max_hr &lt;- max_hr |&gt; \n  min()\n\nmax_max_hr &lt;- max_hr |&gt; \n  max()\n\n\nDetermining the number of intervals. The number of intervals is typically between 10 and 15; here, we adopt 12. The seq() function is used to obtain upper and lower limits of the intervals.\n\n\nbreaks &lt;- seq(min_max_hr, max_max_hr, length.out = 13)\nbreaks\n#&gt;  [1]  60.00  71.25  82.50  93.75 105.00 116.25 127.50 138.75 150.00 161.25\n#&gt; [11] 172.50 183.75 195.00\n\n\nUsing the cut() function to dive each data into their respective intervals.\n\n\ncut(pull(max_hr), breaks = breaks, include.lowest = T, right = F) |&gt; \n  head(40)\n#&gt;  [1] [150,161)   [105,116)   [128,139)   [93.8,105)  [139,150)   [161,172)  \n#&gt;  [7] [116,128)   [150,161)   [150,161)   [128,139)   [116,128)   [128,139)  \n#&gt; [13] [82.5,93.8) [93.8,105)  [116,128)   [161,172)   [116,128)   [93.8,105) \n#&gt; [19] [150,161)   [139,150)   [93.8,105)  [116,128)   [71.2,82.5) [139,150)  \n#&gt; [25] [150,161)   [128,139)   [128,139)   [161,172)   [105,116)   [116,128)  \n#&gt; [31] [93.8,105)  [105,116)   [150,161)   [82.5,93.8) [139,150)   [105,116)  \n#&gt; [37] [128,139)   [150,161)   [116,128)   [82.5,93.8)\n#&gt; 12 Levels: [60,71.2) [71.2,82.5) [82.5,93.8) [93.8,105) ... [184,195]\n\n\n8 intervals per line, with the total number of elements being a multiple of 8. Use empty characters to pad if necessary.\n\n\n\nGenerating the frequency table.\n\n\ncut(pull(max_hr), breaks = breaks, include.lowest = T, right = F) |&gt;\n  table() |&gt; \n  knitr::kable(col.names = c(\"interval\", \"freq\"), align = \"c\")\n\n\n\n\ninterval\nfreq\n\n\n\n\n[60,71.2)\n5\n\n\n[71.2,82.5)\n9\n\n\n[82.5,93.8)\n20\n\n\n[93.8,105)\n43\n\n\n[105,116)\n81\n\n\n[116,128)\n108\n\n\n[128,139)\n68\n\n\n[139,150)\n71\n\n\n[150,161)\n63\n\n\n[161,172)\n25\n\n\n[172,184)\n14\n\n\n[184,195]\n1\n\n\n\n\n\n\n\n2.3.2 Frequency histogram\nA frequency histogram is a graphical representation of a frequency table. It displays the distribution of numerical variales by showing the frequency (count) of a value within specific intervals (bins) on the x-axis, with the y-axis representing the frequency. Each bar in the histogram corresponds to an interval, and the height of the bar indicates how many valuess fall within that range. This visual tool is useful for quickly assessing the shape, spread, and central tendency of the data distribution.\n\nhist(\n  x              = pull(max_hr), \n  breaks         = breaks, \n  freq           = T,\n  right          = F, \n  col            = \"skyblue\", \n  include.lowest = T,\n  main           = \" \",\n  xlab           = \"Maximum heart rate\",\n  ylab           = \"Frequency\",\n  ylim           = c(0, 120),\n  labels         = T\n)\n\n\n\n\n\n\n\n\nAn alternative approach to plot the same histogram is also supplied below.\n\nggplot(max_hr, aes(x = max_hr)) +\n  geom_histogram(\n    fill = \"skyblue\", \n    stat = \"bin\",\n    color = \"black\",\n    linewidth = 0.4,\n    breaks = breaks,\n    closed = \"left\"\n  ) +\n  stat_bin(\n    geom = \"text\", \n    aes(label = after_stat(count)),\n    breaks = breaks, \n    closed = \"left\",\n    vjust = - 0.5\n  ) +\n  labs(x = \"Maximum heart rate\", y = \"Frequency\") +\n  theme(\n    panel.background = element_blank(),        \n    axis.line = element_line(color = \"black\") \n  )",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical description of quantitative data</span>"
    ]
  },
  {
    "objectID": "quat-data-stat-desc.html#measures-of-central-tendency",
    "href": "quat-data-stat-desc.html#measures-of-central-tendency",
    "title": "2  Statistical description of quantitative data",
    "section": "2.4 Measures of central tendency",
    "text": "2.4 Measures of central tendency\nCentral tendency provides a single value representing the center of the data.\n\n2.4.1 Mean\n例2-2 计算例2-1某医院138名正常成年女性的红细胞数的均数。\n\nmax_hr |&gt; \n  pull() |&gt; \n  mean() |&gt; \n  round(digits = 1)\n#&gt; [1] 127.7\n\n\n\n2.4.2 Median\n计算例2-1某医院138名正常成年女性的红细胞数的中位数和四分位数：\n\nmax_hr |&gt; \n  pull() |&gt; \n  median()\n#&gt; [1] 126",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical description of quantitative data</span>"
    ]
  },
  {
    "objectID": "quat-data-stat-desc.html#measures-of-dispersion",
    "href": "quat-data-stat-desc.html#measures-of-dispersion",
    "title": "2  Statistical description of quantitative data",
    "section": "2.5 Measures of dispersion",
    "text": "2.5 Measures of dispersion\nwhile dispersion shows how much the data varies around this central point.\n以例2-1某医院138名正常成年女性的红细胞数为例，计算描述离散趋势的统计指标：\n\n2.5.1 Range\n\nrange(max_hr) |&gt; \n  diff()\n#&gt; [1] 135\n\n\n\n2.5.2 Quartile and percentile\n\nmax_hr |&gt; \n  pull() |&gt; \n  quantile(probs = c(0.25, 0.5, 0.75)) \n#&gt;    25%    50%    75% \n#&gt; 112.00 126.00 144.25\n\nIn R, you can calculate the interquartile range (IQR) of a numeric variable using the IQR() function. Here’s how you can do it:\n\nmax_hr |&gt; \n  pull() |&gt; \n  IQR()\n#&gt; [1] 32.25\n\n\n\n2.5.3 Variance\n\nmax_hr |&gt; \n  pull() |&gt; \n  var()\n#&gt; [1] 546.9482\n\n\n\n2.5.4 Standard deviation\n\nmax_hr |&gt; \n  pull() |&gt; \n  sd()\n#&gt; [1] 23.38692\n\n\n\n2.5.5 变异系数\n\nmean &lt;- max_hr |&gt; \n  pull() |&gt; \n  mean()\n\nsd &lt;- max_hr |&gt; \n  pull() |&gt; \n  sd()\n\n(sd / mean * 100) |&gt; \n  round(digits = 1)\n#&gt; [1] 18.3",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical description of quantitative data</span>"
    ]
  },
  {
    "objectID": "quat-data-stat-desc.html#medical-reference-range",
    "href": "quat-data-stat-desc.html#medical-reference-range",
    "title": "2  Statistical description of quantitative data",
    "section": "2.6 Medical reference range",
    "text": "2.6 Medical reference range\n以例2-1某医院138名正常成年女性的红细胞数为例，确定其医学参考值范围：\n\nmed_ref_range &lt;- quantile(pull(max_hr), probs = c(0.025, 0.975)) |&gt; \n  round(digits = 3) |&gt; \n  print()\n#&gt;    2.5%   97.5% \n#&gt;  82.000 173.325\n\n由上可知，正常成年女性红细胞数的95%医学参考值范围为: (82, 173.325)",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical description of quantitative data</span>"
    ]
  },
  {
    "objectID": "ttest.html",
    "href": "ttest.html",
    "title": "5  Population mean estimation and t test",
    "section": "",
    "text": "5.1 Prerequisites\nlibrary(tidyverse)\nlibrary(kableExtra)\n例3-1 若某市1999年18岁男生身高服从均数为167.7cm，标准差为5.3cm的正态分布。从该正态分布N(167.7, 5.32)cm总体中随机抽样100次即共抽取样本g=100个，每次样本含量10人，计算得到每个样本的均数及标准差，数据以Stata格式保存，利用haven::read_dta()函数导入R变量height_samples中。是部分数据。\nheight_samples &lt;- haven::read_dta(\"datasets/例03-01.dta\") \nhead(height_samples) |&gt; \n  kbl(align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n\n\nno\nmean\nsd\n\n\n\n\n1\n167.41\n2.74\n\n\n2\n165.56\n6.57\n\n\n3\n168.20\n5.36\n\n\n4\n166.67\n4.81\n\n\n5\n164.89\n5.41\n\n\n6\n166.36\n4.50",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Population mean estimation and t test</span>"
    ]
  },
  {
    "objectID": "ttest.html#标准误和可信区间",
    "href": "ttest.html#标准误和可信区间",
    "title": "5  Population mean estimation and t test",
    "section": "5.2 标准误和可信区间",
    "text": "5.2 标准误和可信区间\n\n5.2.1 单一总体均数的可信区间\n例3-2 计算例3-1中每个样本的标准误和可信区间\n\nmean  &lt;- height_samples$mean\nsd    &lt;- height_samples$sd\nlower_bound = vector(mode = \"double\", length = 100)\nupper_bound = vector(mode = \"double\", length = 100)\n\nfor(i in seq(1:100)){\n1  ttest &lt;- DescTools::TTestA(\n  mx = mean[i],\n  sx = sd[i],\n  nx = 10,\n  alternative = \"two.sided\",\n  mu = 167.7\n  )\n  ci &lt;- ttest$conf.int\n  lower_bound[i] &lt;- ci[1]\n  upper_bound[i] &lt;- ci[2]\n}\n\nheight_samples |&gt; \n  mutate(\n    se          = sd / sqrt(10),\n    lower_bound = lower_bound,\n    upper_bound = upper_bound\n  ) |&gt; \n  head()|&gt; \n  kbl(digits = 2, align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n1\n\nTTestA()根据用户提供的统计量进行单个或两个样本 t 检验，而不是像t.test()中那样基于数据直接进行检验；此例是单样本，两样本类同，参见下例。\n\n\n\n\n\n\n\nno\nmean\nsd\nse\nlower_bound\nupper_bound\n\n\n\n\n1\n167.41\n2.74\n0.87\n165.45\n169.37\n\n\n2\n165.56\n6.57\n2.08\n160.86\n170.26\n\n\n3\n168.20\n5.36\n1.69\n164.37\n172.03\n\n\n4\n166.67\n4.81\n1.52\n163.23\n170.11\n\n\n5\n164.89\n5.41\n1.71\n161.02\n168.76\n\n\n6\n166.36\n4.50\n1.42\n163.14\n169.58\n\n\n\n\n\n\n\n\n\n5.2.2 两总体均数差的可信区间\n例3-3 61名患者随机分为两组，已知安慰剂组29例，试验组32例，治疗前安慰剂组IL-2的均数为20.1，标准差为7.02；试验组IL-2的均数为16.89，标准差为8.46。问两组治疗前基线的IL-2相差有多大？\n\nttest &lt;- DescTools::TTestA(\nmx = 20.1,\nmy = 16.89,\nsx = 7.02,\nsy = 8.46,\nnx = 29,\nny = 32,\nalternative = \"two.sided\"\n)\nci &lt;- ttest$conf.int |&gt; \n  round(digits = 2)\n\n因此，两组治疗前基线的IL-2总体均数之差的95%可信区间为(-0.76, 7.18)。",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Population mean estimation and t test</span>"
    ]
  },
  {
    "objectID": "ttest.html#t-检验",
    "href": "ttest.html#t-检验",
    "title": "5  Population mean estimation and t test",
    "section": "5.3 t 检验",
    "text": "5.3 t 检验\n计量资料的假设检验中，最常见、最简单的方法是 t 检验。\n\n5.3.1 单样本 t 检验\n例3-4 某医生测量了36名从事铅作业男性工人的血红蛋白含量，算得其均数为130.83g/L，标准差为25.74g/L。问从事铅作业工人的血红蛋白是否不同于正常成年男性平均值140g/L？\n\nhaven::read_dta(\"datasets/例03-05.dta\") |&gt; \n  t.test(mu = 140) |&gt; \n1  broom::tidy() |&gt;\n  kbl(digits = 3, align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n1\n\n把一个对象变成一个整齐的tibble，方便表的格式化输出\n\n\n\n\n\n\n\nestimate\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n130.833\n-2.137\n0.04\n35\n122.124\n139.543\nOne Sample t-test\ntwo.sided\n\n\n\n\n\n\n\n\n\n5.3.2 配对样本 t 检验\n例3-5 为比较两种方法对乳酸饮料中脂肪含量测定结果是否不同，随机抽取了10份乳酸饮料制品，分别用脂肪酸水解法和哥特里－罗紫法测定其结果。问两法测定结果是否不同？\n\npaired &lt;- haven::read_dta(\"datasets/例03-06.dta\") \nt.test(\n  x = paired$x1,\n  y = paired$x2,\n  paired = T\n) |&gt; \n  broom::tidy() |&gt; \n  kbl(digits = 3, align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n\n\nestimate\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n0.272\n7.926\n0\n9\n0.195\n0.35\nPaired t-test\ntwo.sided\n\n\n\n\n\n\n\n\n\n5.3.3 两样本 t 检验\n例3-6 为研究国产四类新药阿卡波糖胶囊的降血糖效果，某医院用40名II型糖尿病病人进行同期随机对照试验。研究者将这些病人随机等分到试验组(用阿卡波糖胶囊)和对照组(用拜唐苹胶囊)，分别测得试验开始前和8周时的空腹血糖，算得空腹血糖下降值，能否认为该国产四类新药阿卡波糖胶囊与拜唐苹胶囊对空腹血糖的降糖效果不同？\n\ntwo_sample &lt;- haven::read_dta(\"datasets/例03-07.dta\") \nt.test(\n  x = two_sample$x1,\n  y = two_sample$x2,\n) |&gt; \n  broom::tidy() |&gt; \n  kbl(digits = 3, align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n\n\nestimate\nestimate1\nestimate2\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n-0.56\n2.065\n2.625\n-0.642\n0.525\n36.086\n-2.329\n1.209\nWelch Two Sample t-test\ntwo.sided\n\n\n\n\n\n\n\n\n\n5.3.4 近似 t 检验\n进行两小样本均数比较，若两总体方差不等，可采用近似 t 检验:\n例3-7 在上述例3-6国产四类新药阿卡波糖胶囊的降血糖效果研究中，测得用拜唐苹胶囊对照组20例患者和阿卡波糖胶囊试验组20例患者，其8周时糖化血红蛋白HbA1c (%)的下降值见 Table 5.1 。问使用两种不同药物的患者其HbA1c下降值是否相同？\n\n\n\n\nTable 5.1: 阿卡波糖胶囊组和拜唐苹胶囊组HbA1c (%)的下降值\n\n\n\n\n\n\n分组\n\\(n\\)\n\\(\\bar{X}\\)\n\\(S\\)\n\n\n\n\n试验组(阿卡波糖胶囊)\n20\n1.13\n0.70\n\n\n对照组(拜唐苹胶囊)\n20\n1.46\n1.36\n\n\n\n\n\n\n\n\n\nknitr::kable()成功将输出到html的表中的字符渲染为数学符号，其他包函数测试不成功\n\n本例中已知样本均数和方差，标准的t.test()通常用于直接分析数据集而非样本统计量，这里采用DescTools::TTestA()函数。经两样本方差齐性的\\(F\\)检验 (在 Section 5.4 中具体介绍)，两组的总体方差不等，故进行近似 t 检验。\n\nDescTools::TTestA(                              \n  mx = 1.13,\n  my = 1.46,\n  sx = 0.70,\n  sy = 1.36,\n  nx = 20,\n  ny = 20,\n  alternative = \"two.sided\",\n1  var.equal = F\n) |&gt; \n  broom::tidy() |&gt; \n  kbl(digits = 3, align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n1\n\nvar.equal，指示两个方差是否相等的逻辑变量。如果为FALSE，则使用Welch (或Satterthwaite) 法进行近似 t 检验\n\n\n\n\n\n\n\nestimate\nestimate1\nestimate2\nstatistic\np.value\nparameter\nconf.low\nconf.high\nmethod\nalternative\n\n\n\n\n-0.33\n1.13\n1.46\n-0.965\n0.343\n28.407\n-1.03\n0.37\nWelch Two Sample t-test\ntwo.sided",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Population mean estimation and t test</span>"
    ]
  },
  {
    "objectID": "ttest.html#sec-homogeneity-test",
    "href": "ttest.html#sec-homogeneity-test",
    "title": "5  Population mean estimation and t test",
    "section": "5.4 正态和方差齐性检验",
    "text": "5.4 正态和方差齐性检验\n\n5.4.1 正态性检验\n下面对例3-1中的100个样本均数进行正态性检验：\n（一）计算法\n下面分别采用stats::shapiro.test()和DescTools::ShapiroFranciaTest()进行正态性检验：\n\nx &lt;- height_samples |&gt; \n  select(mean) |&gt; \n1  unlist(use.names = F)\n  \n2stats::shapiro.test(x) |&gt;\n  broom::tidy() |&gt; \n  rbind(\n3    DescTools::ShapiroFranciaTest(x) |&gt;\n      broom::tidy()\n  ) |&gt; \n  kbl(digits = 3, align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n1\n\n注意：这里须加unlist(use.names = FALSE)，否则会报错\n\n2\n\nShapiro-Wilk方法\n\n3\n\nShapiro-Francia方法\n\n\n\n\n\n\n\nstatistic\np.value\nmethod\n\n\n\n\n0.994\n0.944\nShapiro-Wilk normality test\n\n\n0.993\n0.802\nShapiro-Francia normality test\n\n\n\n\n\n\n\nshapiro.test(x)要求x是数值型变量，所以虽然tibble中的mean是数值型，但不能直接传递给使用shapiro.test(x)，需加一个unlist(x, use.names = FALSE)操作，否则会报错，如下面代码块所示：\n\nx &lt;- height_samples |&gt; \n  select(mean) \nstats::shapiro.test(x)\n#&gt; Error in stats::shapiro.test(x): is.numeric(x) is not TRUE\n\n（二）图示法\n图示法主要使用分位数图 (P-P图)和概率图 (Q-Q图)，其中以Q-Q图效率较高。如果分析的数据服从正态分布，则图上的数据点应分布在直线附近，否则数据点偏离直线较远。\n\nx &lt;- height_samples |&gt; \n  select(mean) |&gt; \n  unlist(use.names = F)\n\n\nstats::qqnorm(\n  x,\n  main = \"Q-Q图\",\n  xlab = \"理论分位数\",\n  ylab = \"样本分位数\",\n  datax = T\n) \nstats::qqline(\n  x,\n  datax = T\n)\n\n\n\n\n\n\n\n\n\n\n5.4.2 方差齐性检验\n对例3-6的数据，利用\\(F\\)检验判断两总体空腹血糖下降值的方差是否相等。这里利用DescTools::LeveneTest()进行方差齐性检验\n\ntb &lt;- two_sample |&gt; \n1  pivot_longer(\n    cols = everything(),\n    names_to = \"group\"\n  ) |&gt; \n  mutate(\n2    group = as.factor(group)\n  )\nDescTools::LeveneTest(tb$value, group = tb$group) |&gt; \n  broom::tidy() |&gt; \n  kbl(digits = 3, align = \"c\") |&gt;\n  kable_classic(full_width = F) |&gt; \n  row_spec(0, bold = T)\n\n\n1\n\n将原数据框进行拉长转换，以符合DescTools::LeveneTest()参数的要求\n\n2\n\n作为数据分组变量，需转换为因子类型，否则会输出警告\n\n\n\n\n\n\n\nstatistic\np.value\ndf\ndf.residual\n\n\n\n\n0.493\n0.487\n1\n38",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Population mean estimation and t test</span>"
    ]
  },
  {
    "objectID": "cox-regression.html",
    "href": "cox-regression.html",
    "title": "11  Cox regression",
    "section": "",
    "text": "Cox regression, also known as Cox proportional hazards regression, is a statistical method used to analyze the time until an event occurs, typically survival time. It is widely used in medical research to explore the relationship between the survival time of patients and one or more predictor variables. Unlike other models, Cox regression does not require assumptions about the baseline hazard function, making it a flexible tool for handling censored data where the exact time of the event may not be known for all subjects.",
    "crumbs": [
      "Basic statistical methods",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Cox regression</span>"
    ]
  },
  {
    "objectID": "quarto.html",
    "href": "quarto.html",
    "title": "12  Quarto",
    "section": "",
    "text": "12.1 GitHub Action\n呈现和发布内容有几种不同的方法。下面，我们将提供一个使用 GitHub Actions 和 GitHub Pages 发布内容的指南。",
    "crumbs": [
      "Statistical analysis report",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Quarto</span>"
    ]
  },
  {
    "objectID": "quarto.html#github-action",
    "href": "quarto.html#github-action",
    "title": "12  Quarto",
    "section": "",
    "text": "12.1.1 执行代码\n如果你愿意，可以配置一个 GitHub Action 来执行 R 代码作为渲染的一部分。这虽然是最好的方法，但当在 GitHub Actions 等 CI 服务中执行代码时，请考虑以下要求:\n\n你需要在 CI 环境中重新配置所有依赖项（包括 R 以及所需的正确版本的包）。\n如果你的代码需要任何特殊权限（例如访问数据库或网络）， CI 服务器上也需要具备这些权限。\n你的项目可能包含无法轻易执行的文档（例如使用旧版包的几年前的博客文章）。这些文档可能需要单独启用冻结功能，以防止它们在 CI 上执行。\n\n\n\n12.1.2 先决条件\n确保代码可以在 GitHub Action 中执行的最佳方法是为项目使用 renv 虚拟环境。以下是一个完整的 GitHub Action 示例，它安装 R 和 renv.lock 中的包依赖项，然后执行代码并将输出渲染到 GitHub Pages：\n\n\n\n\n\n\nTip\n\n\n\n在 RStudio 左下窗口的 Terminal 选项卡中依次运行以下 Git 命令：\n\ngit remote add origin https://github.com/qbgaoo/r4ms.git\ngit branch -M main\ngit push -u origin main\n\n\n\n在 Quarto 项目中新建文本文件，命名为 publish.yml（当然也可以是其他命字），保存路径为 .github/workflows/publish.yml，在文件中添加如下内容：\non:\n  push:\n    branches: main\n  pull_request:\n    branches: main\n  # to be able to trigger a manual build\n  workflow_dispatch:\n  schedule:\n    # run every day at 11 PM\n    - cron: '0 23 * * *'\n\nname: Render and deploy Book to Github\n\njobs:\n  build-deploy:\n    runs-on: ubuntu-latest\n    permissions:\n      contents: write\n    steps:\n      - name: Check out repository\n        uses: actions/checkout@v4\n\n      - name: Set up Quarto\n        uses: quarto-dev/quarto-actions/setup@v2\n\n      - name: Install R\n        uses: r-lib/actions/setup-r@v2\n        with:\n          r-version: '4.4.1'\n\n      - name: Install R Dependencies\n        uses: r-lib/actions/setup-renv@v2\n        with:\n          cache-version: 1\n\n      - name: Render and Publish\n        uses: quarto-dev/quarto-actions/publish@v2\n        with:\n          target: gh-pages\n        env:\n          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}\n这是一个 GitHub Actions 工作流配置文件，保存后将文件提交到 GitHub中，触发文件中的工作流。",
    "crumbs": [
      "Statistical analysis report",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Quarto</span>"
    ]
  },
  {
    "objectID": "pilot-project.html",
    "href": "pilot-project.html",
    "title": "13  A case to analyze",
    "section": "",
    "text": "13.1 Datasets\nIn this book, we used publicly available CDISC pilot study data, which is accessible through the CDISC GitHub repository. To streamline the process, we have downloaded all the datasets from the repository and converted them from .xpt format to .sas7bdat format for ease of use and compatibility. Then we stored them in the data/adam/ folder within this project. Additionally, The dataset structure adheres to the CDISC Analysis Data Model (ADaM) standard.\nThe SDTM-ADaM Pilot Project datasets were created to demonstrate the process of converting clinical trial data into formats that comply with the Study Data Tabulation Model (SDTM) and Analysis Data Model (ADaM) standards, which are set by the Clinical Data Interchange Standards Consortium (CDISC). These datasets are used to test, validate, and illustrate how to implement CDISC standards in real-world scenarios, helping pharmaceutical companies and regulatory agencies like the FDA ensure data quality and consistency in clinical trials.",
    "crumbs": [
      "Statistical analysis report",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>A case to analyze</span>"
    ]
  },
  {
    "objectID": "basic-stat.html",
    "href": "basic-stat.html",
    "title": "Basic statistical methods",
    "section": "",
    "text": "基本的医学统计方法涵盖了数据的收集、整理、描述、分析和解释，旨在帮助研究者理解疾病的发生、发展、治疗效果及健康状况的分布规律。以下是医学研究中常用的一些基本统计方法：\n\n1. 描述性统计\n\n频率分析：计算各类别或数值出现的频数和百分比。\n集中趋势测量：平均值、中位数和众数，用于描述数据的中心位置。\n离散程度测量：标准差、方差、四分位数间距和极差，反映数据的分散程度。\n\n\n\n2. 推断性统计\n\n参数检验：\n\nt检验：用于比较两组或几组独立或配对样本的均值差异，如学生t检验、配对t检验。\nANOVA（方差分析）：比较多个样本均值是否存在显著差异。\n\n非参数检验：\n\nMann-Whitney U检验（Wilcoxon秩和检验的两样本形式）：适用于连续数据但不符合正态分布的两组样本均值差异检验。\nKruskal-Wallis H检验：多组独立样本的中位数差异检验，适用于非正态分布数据。\n\n卡方检验（Chi-square test）：用于分析分类变量间的关系，如四格表检验。\n\n\n\n3. 回归分析\n\n线性回归：研究一个或多个自变量与一个连续因变量之间的线性关系。\n逻辑回归（Logistic Regression）：适用于因变量为二分类或多元分类的场合，用来估计事件发生概率。\n\n\n\n5. 随机化和抽样\n\n随机化：确保研究的组间可比性。\n抽样技术：包括简单随机抽样、分层抽样、整群抽样等，确保样本代表性。\n\n\n\n6. 误差与功效分析\n\n类型I和II错误的理解，以及统计功效分析，以确定研究设计是否足够强大以检测预期效应。\n\n选择适当的统计方法需依据研究目的、数据类型（定量或定性）、数据分布（正态与否）、样本大小等因素。理解这些基础统计概念和方法对于设计和解读医学研究至关重要。",
    "crumbs": [
      "Basic statistical methods"
    ]
  }
]