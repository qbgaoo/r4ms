<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>27&nbsp; Multilevel model – R for Medical Statistics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./comprehensive-evaluation.html" rel="next">
<link href="./structural-equation.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advanced-stat.html">Advanced methods</a></li><li class="breadcrumb-item"><a href="./multilevel-model.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multilevel model</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Medical Statistics</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://qbgaoo.github.io/r4ms" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-git"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./basic-stat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basic methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quat-data-statdesc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Statistical description of quantitative data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal-distribution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Normal distribution</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./statistical-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Statistical inference</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hypothesis-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Hypothesis test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ttest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">t-test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Analysis of Variance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./count-data-statdesc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Statistical description of count data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discrete-data-dist.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Distributions of discrete variables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chi-square-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Chi-square test</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./nonparametric-test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Nonparametric Tests</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regression-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Bivariate regression and correlation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./advanced-stat.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multifactor-anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Multifactor ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./repeated-measurement.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Repeated measures ANOVA</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./general-linear-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">General linear model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multivariate-groups-diff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Multivariate data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple-linear-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Multiple linear regression analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./logistic-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Logistic regression analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-linear-model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Generalized linear model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Survival analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cluster-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Cluster analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./discriminant-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Discriminant analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca-factor-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Principal components and factor analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./canonical-correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Canonical correlation analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./structural-equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Structural equation model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multilevel-model.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multilevel model</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./comprehensive-evaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comprehensive evaluation methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-estimating-equation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Generalized estimating equation</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./stat-anal-report.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Communication</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./quarto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pilot-project.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">A case to analyze</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./memo.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Memo for future programming</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#prerequisite" id="toc-prerequisite" class="nav-link active" data-scroll-target="#prerequisite"><span class="header-section-number">27.1</span> Prerequisite</a></li>
  <li><a href="#mixed-model" id="toc-mixed-model" class="nav-link" data-scroll-target="#mixed-model"><span class="header-section-number">27.2</span> Mixed model</a></li>
  <li><a href="#variance-component-model" id="toc-variance-component-model" class="nav-link" data-scroll-target="#variance-component-model"><span class="header-section-number">27.3</span> Variance component model</a></li>
  <li><a href="#random-coefficient-model" id="toc-random-coefficient-model" class="nav-link" data-scroll-target="#random-coefficient-model"><span class="header-section-number">27.4</span> Random coefficient model</a></li>
  <li><a href="#multilevel-model-of-discrete-data" id="toc-multilevel-model-of-discrete-data" class="nav-link" data-scroll-target="#multilevel-model-of-discrete-data"><span class="header-section-number">27.5</span> Multilevel model of discrete data</a>
  <ul class="collapse">
  <li><a href="#reliability-assessment" id="toc-reliability-assessment" class="nav-link" data-scroll-target="#reliability-assessment"><span class="header-section-number">27.5.1</span> Reliability assessment</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://qbgaoo.github.io/r4ms/edit/main/multilevel-model.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://qbgaoo.github.io/r4ms/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./advanced-stat.html">Advanced methods</a></li><li class="breadcrumb-item"><a href="./multilevel-model.html"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multilevel model</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Multilevel model</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A multilevel model (also known as hierarchical linear modeling or mixed-effects modeling) is a statistical approach used when data are organized at more than one level. This type of model is particularly useful when the assumptions of independence between observations are violated, which often happens when data are grouped or clustered.</p>
<section id="prerequisite" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="prerequisite"><span class="header-section-number">27.1</span> Prerequisite</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmerTest)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(metafor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="mixed-model" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="mixed-model"><span class="header-section-number">27.2</span> Mixed model</h2>
<p>A mixed model (or mixed-effects model) is a statistical model that combines both fixed effects and random effects. These models are often used when data have a hierarchical or grouped structure, allowing for correlation within groups and enabling analysis across multiple levels of data. Mixed models are common in fields like psychology, biology, and medical research, where data may involve repeated measures or nested data structures.</p>
<p>Key components of a mixed model:</p>
<ol type="1">
<li>Fixed effects: Parameters that apply consistently across all individuals or experimental units, such as a treatment effect or a general time effect.</li>
<li>Random effects: Parameters that vary across levels of a grouping variable (such as participants or regions), accounting for individual differences or group-specific deviations. Random effects help control for variability due to these groupings.</li>
<li>Residual variability: Captures the unexplained variability within each level of the grouping structure.</li>
</ol>
<p>A mixed model can be expressed as:</p>
<p><span class="math display">
Y_{ij} = \beta_0 + \beta_1 X_{ij} + u_{0j} + u_{1j}X_{ij} + \epsilon_{ij}
</span></p>
<p>where <span class="math inline">Y_{ij}</span> is the response variable for observation <span class="math inline">i</span> in group <span class="math inline">j</span>, <span class="math inline">\beta_0</span> and <span class="math inline">\beta_1</span> are fixed effects coefficients<em>,</em> <span class="math inline">X_{ij}</span>is the predictor variable for observation <span class="math inline">i</span> in group <span class="math inline">j</span>, <span class="math inline">u_{0j}</span> is the random intercept for group <span class="math inline">j</span>, capturing random differences in initial levels between groups and typically assumed to follow a normal distribution with mean 0 and variance <span class="math inline">\sigma_u^2</span>, <span class="math inline">u_{ij}</span> is the random slope for group <span class="math inline">j</span>, allowing the effect of the predictor <span class="math inline">X_{ij}</span> to vary across groups,<span class="math inline">\epsilon_{ij}</span> is the residual error for each observation.</p>
<p>Applications of mixed models:</p>
<ol type="1">
<li>Repeated measures: Analyzing data collected from the same individuals at multiple time points.</li>
<li>Hierarchical data: For data that involve multiple nested levels, such as patients within hospitals.</li>
<li>Random intercepts and slopes: Random intercepts allow different groups to have different baseline levels, while random slopes allow for different relationships between predictors and outcomes within each group.</li>
</ol>
<div class="example">
<strong>Example 1:</strong> 
<p>A researcher randomly selected 10 patients with mild hypertension and measured their diastolic blood pressure before and after taking a medication. Analyze the changes in diastolic blood pressure before and after treatment.</p>
</div>
<div>
<p><a href="datasets/ex27-01.csv" download="ex27-01.csv" class="btn btn-success"> <i class="bi bi-database-fill-down"></i> Download data </a></p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/ex27-01.csv"</span>, <span class="at">show_col_types =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(bp <span class="sc">~</span> state <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>subject ), <span class="at">data =</span> df) </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed model fit by REML. t-tests use Satterthwaite's method [
#&gt; lmerModLmerTest]
#&gt; Formula: bp ~ state + (1 | subject)
#&gt;    Data: df
#&gt; 
#&gt; REML criterion at convergence: 113.9
#&gt; 
#&gt; Scaled residuals: 
#&gt;     Min      1Q  Median      3Q     Max 
#&gt; -1.1422 -0.5311  0.1307  0.4070  1.5714 
#&gt; 
#&gt; Random effects:
#&gt;  Groups   Name        Variance Std.Dev.
#&gt;  subject  (Intercept) 63.511   7.969   
#&gt;  Residual              4.889   2.211   
#&gt; Number of obs: 20, groups:  subject, 10
#&gt; 
#&gt; Fixed effects:
#&gt;             Estimate Std. Error       df t value Pr(&gt;|t|)    
#&gt; (Intercept) 126.2000     2.6153   9.6662   48.25 7.56e-13 ***
#&gt; state       -16.0000     0.9888   9.0000  -16.18 5.83e-08 ***
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
#&gt; 
#&gt; Correlation of Fixed Effects:
#&gt;       (Intr)
#&gt; state -0.189</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> equatiomatic<span class="sc">::</span><span class="fu">extract_eq</span>(<span class="at">mean_separate =</span> T, <span class="at">use_coefs =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><span class="math display">
\begin{aligned}
  \operatorname{\widehat{bp}}_{i}  &amp;\sim N \left(\mu, \sigma^2 \right) \\
    \mu &amp;=126.2_{\alpha_{j[i]}} - 16_{\beta_{1}}(\operatorname{state}) \\
    \alpha_{j}  &amp;\sim N \left(0, 7.97 \right)
    \text{, for subject j = 1,} \dots \text{,J}
\end{aligned}
</span></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Packages for linear mixed models
</div>
</div>
<div class="callout-body-container callout-body">
<p>The <code>nlme</code>, <code>lme4</code> and <code>lmerTest</code> packages are all used for fitting linear mixed-effects models, but they serve different purposes and offer distinct functionalities. Here’s a detailed comparison:</p>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 26%">
<col style="width: 24%">
<col style="width: 24%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th><strong><code>nlme</code></strong></th>
<th><strong><code>lme4</code></strong></th>
<th><strong><code>lmerTest</code></strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Model types</strong></td>
<td>Supports both <strong>linear</strong> and <strong>nonlinear</strong> mixed-effects models.</td>
<td>Supports <strong>linear</strong> mixed-effects models (no nonlinear support).</td>
<td>Same as <code>lme4</code>, but with added p-values and ANOVA tables for hypothesis testing.</td>
</tr>
<tr class="even">
<td><strong>Optimization</strong></td>
<td>Uses <strong>maximum likelihood (ML)</strong> or <strong>restricted maximum likelihood (REML)</strong> for estimation, but optimization methods are generally slower.</td>
<td>Also uses <strong>ML</strong> and <strong>REML</strong>, but employs <strong>faster</strong> and more efficient optimization methods, particularly for large datasets.</td>
<td>Same as <code>lme4</code> (uses <code>lme4</code> for model fitting).</td>
</tr>
<tr class="odd">
<td><strong>Nonlinear modeling</strong></td>
<td><strong>Supports nonlinear mixed-effects models</strong>, making it more flexible for modeling complex, nonlinear relationships.</td>
<td>Does not support nonlinear models, limited to linear mixed-effects models.</td>
<td>Same as <code>lme4</code>, limited to linear mixed-effects models.</td>
</tr>
<tr class="even">
<td><strong>Correlation structures</strong></td>
<td>Can handle <strong>more complex correlation structures</strong> (e.g., autocorrelation, spatial correlation, heteroscedasticity).</td>
<td>Limited support for correlation structures, primarily for random effects.</td>
<td>Same as <code>lme4</code>.</td>
</tr>
<tr class="odd">
<td><strong>Handling of missing data</strong></td>
<td>Can handle <strong>missing data</strong> via the <strong><code>na.action</code></strong> argument and imputation methods.</td>
<td>Requires complete data, no built-in missing data handling beyond the standard options.</td>
<td>Same as <code>lme4</code>.</td>
</tr>
<tr class="even">
<td><strong>Grouping levels</strong></td>
<td>Offers greater flexibility for <strong>nested or crossed random effects</strong> at multiple levels.</td>
<td>Supports nested and crossed random effects, but not as flexible in terms of specifying correlation structures.</td>
<td>Same as <code>lme4</code>.</td>
</tr>
<tr class="odd">
<td><strong>p-values for fixed effects</strong></td>
<td>Provides <strong>p-values</strong> for fixed effects by default.</td>
<td>Does <strong>not</strong> provide p-values by default (as it’s debated in the mixed-effects model community).</td>
<td><strong>Provides p-values</strong> for fixed effects using Satterthwaite’s or Kenward-Roger’s approximation.</td>
</tr>
<tr class="even">
<td><strong>Model complexity</strong></td>
<td>Better for handling more complex models with <strong>nonlinear effects</strong> and <strong>autocorrelated errors</strong>.</td>
<td>Faster for simpler, large linear mixed-effects models.</td>
<td>Same as <code>lme4</code> but adds hypothesis testing tools like p-values and ANOVA.</td>
</tr>
<tr class="odd">
<td><strong>Performance</strong></td>
<td>Slower, especially with large datasets and complex models.</td>
<td>Faster and more efficient, particularly with large datasets.</td>
<td>Same as <code>lme4</code>.</td>
</tr>
<tr class="even">
<td><strong>User interface</strong></td>
<td>Slightly more complicated interface (uses <code>lme()</code> for linear models and <code>nlme()</code> for nonlinear).</td>
<td>Simpler syntax for linear mixed-effects models (uses <code>lmer()</code>).</td>
<td>Same as <code>lme4</code>.</td>
</tr>
<tr class="odd">
<td><strong>Model comparison</strong></td>
<td>Allows comparison using likelihood ratio tests (e.g., <code>anova()</code> for nested models).</td>
<td>Supports model comparison but does not provide p-values.</td>
<td>Same as <code>lme4</code>, but includes p-values for hypothesis testing.</td>
</tr>
<tr class="even">
<td><strong>Diagnostic plots</strong></td>
<td><strong>More diagnostic plots</strong> available for assessing model fit, residuals, and random effects.</td>
<td>Fewer built-in diagnostic plots, but can be extended with additional functions.</td>
<td>Same as <code>lme4</code>.</td>
</tr>
</tbody>
</table>
<p>In general, use <code>lme4</code> for large, linear mixed-effects models; use <code>lmerTest</code> for p-values and hypothesis testing; and use <code>nlme</code> for more complex models, particularly nonlinear ones or those requiring advanced correlation structures.</p>
<p>The <code>brm()</code> function from <code>brms</code> package can fit a Bayesian generalized linear multivariate multilevel model. The <code>brms</code> is a high-level package that provides an intuitive interface for fitting Bayesian models using Stan on the backend, abstracting away the need to write Stan code manually. It’s similar to the lme4 package but for Bayesian models.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>bayes_fit <span class="ot">&lt;-</span> <span class="fu">brm</span>(bp <span class="sc">~</span> state <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span>subject), <span class="at">data =</span> df, <span class="at">silent =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).
#&gt; Chain 1: 
#&gt; Chain 1: Gradient evaluation took 6.3e-05 seconds
#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.63 seconds.
#&gt; Chain 1: Adjust your expectations accordingly!
#&gt; Chain 1: 
#&gt; Chain 1: 
#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)
#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)
#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)
#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)
#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)
#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)
#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)
#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)
#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)
#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)
#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)
#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)
#&gt; Chain 1: 
#&gt; Chain 1:  Elapsed Time: 0.136 seconds (Warm-up)
#&gt; Chain 1:                0.085 seconds (Sampling)
#&gt; Chain 1:                0.221 seconds (Total)
#&gt; Chain 1: 
#&gt; 
#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 2).
#&gt; Chain 2: 
#&gt; Chain 2: Gradient evaluation took 5e-06 seconds
#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
#&gt; Chain 2: Adjust your expectations accordingly!
#&gt; Chain 2: 
#&gt; Chain 2: 
#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)
#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)
#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)
#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)
#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)
#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)
#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)
#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)
#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)
#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)
#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)
#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)
#&gt; Chain 2: 
#&gt; Chain 2:  Elapsed Time: 0.093 seconds (Warm-up)
#&gt; Chain 2:                0.048 seconds (Sampling)
#&gt; Chain 2:                0.141 seconds (Total)
#&gt; Chain 2: 
#&gt; 
#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 3).
#&gt; Chain 3: 
#&gt; Chain 3: Gradient evaluation took 5e-06 seconds
#&gt; Chain 3: 1000 transitions using 10 leapfrog steps per transition would take 0.05 seconds.
#&gt; Chain 3: Adjust your expectations accordingly!
#&gt; Chain 3: 
#&gt; Chain 3: 
#&gt; Chain 3: Iteration:    1 / 2000 [  0%]  (Warmup)
#&gt; Chain 3: Iteration:  200 / 2000 [ 10%]  (Warmup)
#&gt; Chain 3: Iteration:  400 / 2000 [ 20%]  (Warmup)
#&gt; Chain 3: Iteration:  600 / 2000 [ 30%]  (Warmup)
#&gt; Chain 3: Iteration:  800 / 2000 [ 40%]  (Warmup)
#&gt; Chain 3: Iteration: 1000 / 2000 [ 50%]  (Warmup)
#&gt; Chain 3: Iteration: 1001 / 2000 [ 50%]  (Sampling)
#&gt; Chain 3: Iteration: 1200 / 2000 [ 60%]  (Sampling)
#&gt; Chain 3: Iteration: 1400 / 2000 [ 70%]  (Sampling)
#&gt; Chain 3: Iteration: 1600 / 2000 [ 80%]  (Sampling)
#&gt; Chain 3: Iteration: 1800 / 2000 [ 90%]  (Sampling)
#&gt; Chain 3: Iteration: 2000 / 2000 [100%]  (Sampling)
#&gt; Chain 3: 
#&gt; Chain 3:  Elapsed Time: 0.09 seconds (Warm-up)
#&gt; Chain 3:                0.058 seconds (Sampling)
#&gt; Chain 3:                0.148 seconds (Total)
#&gt; Chain 3: 
#&gt; 
#&gt; SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 4).
#&gt; Chain 4: 
#&gt; Chain 4: Gradient evaluation took 1.1e-05 seconds
#&gt; Chain 4: 1000 transitions using 10 leapfrog steps per transition would take 0.11 seconds.
#&gt; Chain 4: Adjust your expectations accordingly!
#&gt; Chain 4: 
#&gt; Chain 4: 
#&gt; Chain 4: Iteration:    1 / 2000 [  0%]  (Warmup)
#&gt; Chain 4: Iteration:  200 / 2000 [ 10%]  (Warmup)
#&gt; Chain 4: Iteration:  400 / 2000 [ 20%]  (Warmup)
#&gt; Chain 4: Iteration:  600 / 2000 [ 30%]  (Warmup)
#&gt; Chain 4: Iteration:  800 / 2000 [ 40%]  (Warmup)
#&gt; Chain 4: Iteration: 1000 / 2000 [ 50%]  (Warmup)
#&gt; Chain 4: Iteration: 1001 / 2000 [ 50%]  (Sampling)
#&gt; Chain 4: Iteration: 1200 / 2000 [ 60%]  (Sampling)
#&gt; Chain 4: Iteration: 1400 / 2000 [ 70%]  (Sampling)
#&gt; Chain 4: Iteration: 1600 / 2000 [ 80%]  (Sampling)
#&gt; Chain 4: Iteration: 1800 / 2000 [ 90%]  (Sampling)
#&gt; Chain 4: Iteration: 2000 / 2000 [100%]  (Sampling)
#&gt; Chain 4: 
#&gt; Chain 4:  Elapsed Time: 0.114 seconds (Warm-up)
#&gt; Chain 4:                0.058 seconds (Sampling)
#&gt; Chain 4:                0.172 seconds (Total)
#&gt; Chain 4:</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>bayes_fit <span class="sc">|&gt;</span> <span class="fu">summary</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt;  Family: gaussian 
#&gt;   Links: mu = identity; sigma = identity 
#&gt; Formula: bp ~ state + (1 | subject) 
#&gt;    Data: df (Number of observations: 20) 
#&gt;   Draws: 4 chains, each with iter = 2000; warmup = 1000; thin = 1;
#&gt;          total post-warmup draws = 4000
#&gt; 
#&gt; Multilevel Hyperparameters:
#&gt; ~subject (Number of levels: 10) 
#&gt;               Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
#&gt; sd(Intercept)     8.65      2.42     5.12    14.27 1.00      673     1456
#&gt; 
#&gt; Regression Coefficients:
#&gt;           Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
#&gt; Intercept   126.46      2.79   121.43   132.19 1.01      746     1007
#&gt; state       -15.99      1.26   -18.54   -13.51 1.00     2348     1523
#&gt; 
#&gt; Further Distributional Parameters:
#&gt;       Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS
#&gt; sigma     2.66      0.89     1.59     4.87 1.01      755      899
#&gt; 
#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS
#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential
#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</code></pre>
</div>
</div>
</section>
<section id="variance-component-model" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="variance-component-model"><span class="header-section-number">27.3</span> Variance component model</h2>
<p>A variance component model is used to handle multilevel data, particularly when the data exhibits clear within-group and between-group variability. The primary objective of this model is to decompose the total variance into different variance components, often used to measure variability at different levels.</p>
<p>A random intercept model is a specific type of variance component model. In a random intercept model, each group has its own intercept, which represents the group-specific deviation from the overall mean. However, the slope (relationship between predictors and the outcome) is assumed to be fixed across groups. The random intercept introduces between-group variation, which is one of the variance components in the model.</p>
<p>Variance component models are typically a special case of mixed-effects models. In these models, random effects capture variability across different levels (such as individual or group-level differences), while fixed effects describe the average relationship between variables.</p>
<p>A variance component model can be expressed as:</p>
<p><span class="math display">
Y_{ij} = \mu + u_j + e_{ij}
</span></p>
<p>where <span class="math inline">Y_{ij}</span> is a observation <span class="math inline">i</span> within group <span class="math inline">j</span>, <span class="math inline">\mu</span> is overall mean, <span class="math inline">u_j</span> is random effect for group <span class="math inline">j</span>, representing the variability between groups, assumed to follow <span class="math inline">u_j \sim N(0, \sigma_u^2)</span><em>,</em> <span class="math inline">e_{ij}</span> is residual (within-group error), assumed to follow <span class="math inline">e_{ij} \sim N(0, \sigma_e^2)</span>.</p>
<p>The total variance <span class="math inline">S_{Y_{ij}}</span> is decomposed into two parts:</p>
<p><span class="math display">
S_{Y_{ij}} = \sigma_u^2 + \sigma_e^2
</span></p>
<p>where <span class="math inline">\sigma_u^2</span> is the variance between groups (random effect), <span class="math inline">\sigma_e^2</span> is the variance within groups (residual error).</p>
<p>Variance component models are widely used in the analysis of nested data. For example:</p>
<blockquote class="blockquote">
<p>Patients (individuals) are nested within hospitals (groups). The total variance can be separated into hospital-level variation and patient-level variation.</p>
</blockquote>
<p>Variance component models are typically estimated using maximum likelihood estimation (MLE) or restricted maximum likelihood estimation (REML). The packages like <code>lme4</code> or <code>nlme</code> are used to fit variance component models.</p>
<div class="example">
<strong>Example 2:</strong> 
<p>A researcher intends to use a meta-analysis to understand the effect of migraines on adult depression. The literature search was conducted up and 16 eligible studies were included. Each study was independent and had the same research hypothesis. The available data include the odds ratios (OR) for each study, as well as study-level explanatory variables such as sample size, whether adjustments for education level were made, and study region, as shown in the data file. Please use R to perform a variance components model analysis.</p>
</div>
<div>
<p><a href="datasets/ex27-02.csv" download="ex27-02.csv" class="btn btn-success"> <i class="bi bi-database-fill-down"></i> Download data </a></p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/ex27-02.csv"</span>, <span class="at">show_col_types =</span> F) <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">as.factor</span>(id),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">edu_adj =</span> <span class="fu">as.factor</span>(edu_adj),</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">study_rgn =</span> <span class="fu">as.factor</span>(study_rgn)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rma</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">yi =</span> <span class="fu">log</span>(or),</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vi =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(n_sample), </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> tb, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mods =</span> <span class="sc">~</span> edu_adj <span class="sc">+</span> study_rgn , </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"REML"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; 
#&gt; Mixed-Effects Model (k = 16; tau^2 estimator: REML)
#&gt; 
#&gt; tau^2 (estimated amount of residual heterogeneity):     0.1306 (SE = 0.0590)
#&gt; tau (square root of estimated tau^2 value):             0.3614
#&gt; I^2 (residual heterogeneity / unaccounted variability): 89.74%
#&gt; H^2 (unaccounted variability / sampling variability):   9.75
#&gt; R^2 (amount of heterogeneity accounted for):            0.00%
#&gt; 
#&gt; Test for Residual Heterogeneity:
#&gt; QE(df = 13) = 100.0999, p-val &lt; .0001
#&gt; 
#&gt; Test of Moderators (coefficients 2:3):
#&gt; QM(df = 2) = 0.0784, p-val = 0.9616
#&gt; 
#&gt; Model Results:
#&gt; 
#&gt;             estimate      se     zval    pval    ci.lb   ci.ub      
#&gt; intrcpt       0.6516  0.1934   3.3697  0.0008   0.2726  1.0307  *** 
#&gt; edu_adj1     -0.0446  0.2486  -0.1792  0.8578  -0.5319  0.4427      
#&gt; study_rgn1    0.0610  0.2245   0.2718  0.7858  -0.3790  0.5010      
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Variance component models can be extended to more complex multilevel models. For example, in data with multiple nested levels, the model can be expanded to account for three or more levels, capturing additional random effects.</p>
</section>
<section id="random-coefficient-model" class="level2" data-number="27.4">
<h2 data-number="27.4" class="anchored" data-anchor-id="random-coefficient-model"><span class="header-section-number">27.4</span> Random coefficient model</h2>
<p>A random coefficient model (also known as a random slopes model) is an extension of a random intercept model. In a random intercept model, only the intercept varies between groups, while the slope (relationship between predictors and the response) is fixed. In a random coefficient model, both the intercept and the slope can vary between groups, which allows for capturing the different relationships between predictors and the response across groups.</p>
<p>Suppose we have data where measurements are taken on individuals across different time points, and we want to model not only the overall trend (intercept) but also allow the effect of time to vary by individual (random slopes). A random coefficient model with a random slope can be written as:</p>
<p><span class="math display">
Y_{ij} = (\beta_0 + b_{0i}) + (\beta_1 + b_{1i}) \cdot X_{ij} + \epsilon_{ij}
</span></p>
<p>where<span class="math inline">Y_{ij}</span> is the outcome for individual <span class="math inline">i</span> at time <span class="math inline">i</span>, <span class="math inline">\beta_0</span>is the fixed intercept (average starting point),<span class="math inline">b_{0i}</span> is the random intercept for individual <span class="math inline">i</span>, <span class="math inline">\beta_1</span> <em>is the</em> fixed slope (average rate of change over time), <span class="math inline">b_{1i}</span> is the random slope for individual <span class="math inline">i</span> (individual variation in the rate of change), <span class="math inline">X_{ij}</span> is the time variable for individual <span class="math inline">i</span> at time <span class="math inline">j</span>, <span class="math inline">\epsilon_{ij}</span> is the residual error.</p>
<div class="example">
<strong>Example 3:</strong> 
<p>To study the efficacy of treatments A and B on patients with leukopenia, a random method was used. 50 patients first received treatment A, followed by a break, and then received treatment B. Another 50 patients received treatment B first, followed by the same interval, and then treatment A. White blood cell counts were recorded after each treatment, as shown in the data.</p>
</div>
<div>
<p><a href="datasets/ex27-03.csv" download="ex27-03.csv" class="btn btn-success"> <i class="bi bi-database-fill-down"></i> Download data </a></p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"datasets/ex27-03.csv"</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">col_types =</span> <span class="fu">list</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">id =</span> <span class="fu">col_factor</span>(), <span class="at">period =</span> <span class="fu">col_factor</span>(), <span class="at">treat =</span> <span class="fu">col_factor</span>()</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  )) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can use the <code>lmer()</code> function from the <code>lmerTest</code> package to fit a random coefficient model:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(wbc <span class="sc">~</span> treat <span class="sc">+</span> period <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">dummy</span>(period) <span class="sc">||</span> id), <span class="at">data =</span> tb)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed model fit by REML ['lmerModLmerTest']
#&gt; Formula: wbc ~ treat + period + (1 + dummy(period) || id)
#&gt;    Data: tb
#&gt; REML criterion at convergence: 271.9579
#&gt; Random effects:
#&gt;  Groups   Name          Std.Dev.
#&gt;  id       (Intercept)   0.1644  
#&gt;  id.1     dummy(period) 0.5773  
#&gt;  Residual               0.8277  
#&gt; Number of obs: 100, groups:  id, 50
#&gt; Fixed Effects:
#&gt; (Intercept)       treatA      period2  
#&gt;      6.9358      -0.1889      -0.5024</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(wbc <span class="sc">~</span> treat <span class="sc">+</span> period <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> <span class="fu">dummy</span>(period) <span class="sc">||</span> id), <span class="at">data =</span> tb)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fit2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed model fit by REML ['lmerModLmerTest']
#&gt; Formula: wbc ~ treat + period + (0 + dummy(period) || id)
#&gt;    Data: tb
#&gt; REML criterion at convergence: 272.0055
#&gt; Random effects:
#&gt;  Groups   Name          Std.Dev.
#&gt;  id       dummy(period) 0.5773  
#&gt;  Residual               0.8440  
#&gt; Number of obs: 100, groups:  id, 50
#&gt; Fixed Effects:
#&gt; (Intercept)       treatA      period2  
#&gt;      6.9359      -0.1892      -0.5024</code></pre>
</div>
</div>
<p>In this example code block:</p>
<ul>
<li>The <code>0 +</code> notation removes the intercept in random effects, so only random slopes are modeled.</li>
<li>The <code>1 +</code> notation adds a random intercept along with the random slopes.</li>
<li>The <code>||</code> notation specifies that random slopes are uncorrelated, which can help if the model is too complex and causing convergence issues.</li>
</ul>
<p>You might want to compare a random intercept model with a random coefficient model to see if adding random slopes improves the fit. This can be done with a likelihood ratio test:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit1, fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Data: tb
#&gt; Models:
#&gt; fit2: wbc ~ treat + period + (0 + dummy(period) || id)
#&gt; fit1: wbc ~ treat + period + (1 + dummy(period) || id)
#&gt;      npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
#&gt; fit2    5 276.01 289.04 -133.00   266.01                     
#&gt; fit1    6 277.93 293.56 -132.96   265.93 0.0859  1     0.7695</code></pre>
</div>
</div>
<p>If the random coefficient model significantly improves the fit compared to the random intercept model, it suggests that there is substantial individual variability in the slopes (i.e., the effect of time varies by individual).</p>
<p>Using <code>period + treat || id</code> treats both <em>period</em> and <em>treat</em> as uncorrelated random slopes within each id.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(wbc <span class="sc">~</span> treat <span class="sc">+</span> period <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> <span class="fu">dummy</span>(treat)  <span class="sc">+</span> <span class="fu">dummy</span>(period) <span class="sc">||</span> id), <span class="at">data =</span> tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed model fit by REML ['lmerModLmerTest']
#&gt; Formula: wbc ~ treat + period + (0 + dummy(treat) + dummy(period) || id)
#&gt;    Data: tb
#&gt; REML criterion at convergence: 272.0055
#&gt; Random effects:
#&gt;  Groups   Name          Std.Dev.
#&gt;  id       dummy(treat)  0.0000  
#&gt;  id.1     dummy(period) 0.5773  
#&gt;  Residual               0.8440  
#&gt; Number of obs: 100, groups:  id, 50
#&gt; Fixed Effects:
#&gt; (Intercept)       treatA      period2  
#&gt;      6.9359      -0.1892      -0.5024  
#&gt; optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(wbc <span class="sc">~</span> treat <span class="sc">+</span> period <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">dummy</span>(treat)  <span class="sc">+</span> <span class="fu">dummy</span>(period) <span class="sc">||</span> id), <span class="at">data =</span> tb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Linear mixed model fit by REML ['lmerModLmerTest']
#&gt; Formula: wbc ~ treat + period + (1 + dummy(treat) + dummy(period) || id)
#&gt;    Data: tb
#&gt; REML criterion at convergence: 271.9579
#&gt; Random effects:
#&gt;  Groups   Name          Std.Dev.
#&gt;  id       (Intercept)   0.1643  
#&gt;  id.1     dummy(treat)  0.0000  
#&gt;  id.2     dummy(period) 0.5773  
#&gt;  Residual               0.8277  
#&gt; Number of obs: 100, groups:  id, 50
#&gt; Fixed Effects:
#&gt; (Intercept)       treatA      period2  
#&gt;      6.9358      -0.1889      -0.5024  
#&gt; optimizer (nloptwrap) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings</code></pre>
</div>
</div>
<p>You can also fit a random coefficient model with the <code>nlme</code> package, though syntax differs slightly. If you prefer a Bayesian approach, the <code>brms</code> package also supports random coefficient models.</p>
<p>This random coefficient model is especially useful in longitudinal studies or hierarchical data, where you expect individual-level differences in how predictors affect the outcome.</p>
</section>
<section id="multilevel-model-of-discrete-data" class="level2" data-number="27.5">
<h2 data-number="27.5" class="anchored" data-anchor-id="multilevel-model-of-discrete-data"><span class="header-section-number">27.5</span> Multilevel model of discrete data</h2>
<p>For discrete data in a multilevel model, generalized linear mixed models (GLMMs) are commonly used. GLMMs extend linear mixed models to handle non-continuous outcomes, such as binary or multinomial responses.</p>
<p>The general form of a GLMM is:</p>
<p><span class="math display">
\text{link}(\mathbb{E}(Y)) = X\beta + Zb
</span></p>
<p>where <span class="math inline">Y</span> is the discrete dependent variable (e.g., binary 0 or 1), <span class="math inline">X \beta</span> is fixed effects, <span class="math inline">Zb</span> is random effects, <span class="math inline">\text {link}()</span> is a link function to handle non-normality in discrete data, such as <span class="math inline">\text {logit}</span> (for logistic regression) or <span class="math inline">\text {log}</span> (for Poisson regression).</p>
<p>You can use the <code>glmer()</code> function from the lme4 package to fit these models. For a binary outcome (e.g., success/failure), you can use the <span class="math inline">\text {logit}</span> link function. For categorical outcomes with more than two categories, a multinomial (multiclass) model is appropriate. Since <code>glmer()</code> doesn’t directly support multinomial regression, you can use <code>nnet::multinom()</code> or <code>brms::brm()</code> for Bayesian multinomial mixed models. For count data, you can use a Poisson or negative binomial distribution.</p>
<div class="example">
<strong>Example 4:</strong> 
<p>Below is a questionnaire survey data, conducted by 20 investigators on 135 rural community doctors, analyzed responses to the following three questions:</p>
<ol type="1">
<li>“Patients often ask doctors to prescribe a specific antibiotic, have you encountered this situation?”</li>
<li>“If a patient requests a specific antibiotic, do you agree to prescribe it?”</li>
<li>“Some doctors believe that for patients whose medication costs are not reimbursable, they should prescribe more antibiotics or more expensive antibiotics. Do you agree with this opinion?”</li>
</ol>
<p>Responses to each question are binary (“Yes” or “No”), with no repeated measures for the questions. The number of doctors surveyed by each investigator varies, meaning the data are unbalanced.</p>
</div>
<div>
<p><a href="datasets/ex27-04.csv" download="ex27-04.csv" class="btn btn-success"> <i class="bi bi-database-fill-down"></i> Download data </a></p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>tb <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"datasets/ex27-04.csv"</span>, <span class="at">show_col_types =</span> F) <span class="sc">|&gt;</span> </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">contains</span>(<span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"que"</span>)), as.factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glmer</span>(que1 <span class="sc">~</span> doc_exp <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> doc_exp <span class="sc">||</span> ivt_id), <span class="at">data =</span> tb, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span> <span class="st">"logit"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>#&gt; Generalized linear mixed model fit by maximum likelihood (Laplace
#&gt;   Approximation) [glmerMod]
#&gt;  Family: binomial  ( logit )
#&gt; Formula: que1 ~ doc_exp + (1 + doc_exp || ivt_id)
#&gt;    Data: tb
#&gt;       AIC       BIC    logLik  deviance  df.resid 
#&gt;  449.0722  464.1455 -220.5361  441.0722       316 
#&gt; Random effects:
#&gt;  Groups   Name        Std.Dev.
#&gt;  ivt_id   (Intercept) 0.261893
#&gt;  ivt_id.1 doc_exp     0.007491
#&gt; Number of obs: 320, groups:  ivt_id, 20
#&gt; Fixed Effects:
#&gt; (Intercept)      doc_exp  
#&gt;    -0.19873      0.00394</code></pre>
</div>
</div>
<section id="reliability-assessment" class="level3" data-number="27.5.1">
<h3 data-number="27.5.1" class="anchored" data-anchor-id="reliability-assessment"><span class="header-section-number">27.5.1</span> Reliability assessment</h3>
<p>Multilevel models for discrete data hold unique value in assessing questionnaire reliability, especially in studies where responses are influenced by hierarchical structures or clustering effects. Here’s why these models are particularly advantageous:</p>
<ol type="1">
<li><p>Addressing hierarchical structure and nested effects</p>
<p>Questionnaire data often involve a natural hierarchy, such as responses collected by different interviewers or across diverse locations. Multilevel models allow for this complexity by adding random effects at various levels (e.g., interviewers or locations), thus accurately accounting for variations in responses due to these nested structures. This prevents underestimation of reliability and provides a more accurate picture of the questionnaire’s consistency.</p></li>
<li><p>Suitability for discrete response variables</p>
<p>Responses in reliability studies are typically discrete, such as binary “yes/no” answers or ordinal scales. Multilevel models are well-suited to handle such data through link functions like logit or probit, allowing for reliable modeling of these non-continuous variables. This ability to directly model the response distribution improves accuracy in reliability estimates, especially when items vary widely in response patterns.</p></li>
<li><p>Quantifying item-specific and overall reliability</p>
<p>By treating items as a separate level in the model, multilevel approaches can isolate the variance associated with each questionnaire item through random effects. This item-level analysis provides crucial insights into the consistency of individual items and contributes to an overall reliability measure that is richer and more detailed than traditional metrics.</p></li>
<li><p>Enabling complex reliability metrics beyond standard measures</p>
<p>Unlike standard reliability coefficients (e.g., Cronbach’s α), multilevel models offer the flexibility to calculate advanced reliability metrics, such as hierarchical reliability coefficients. By leveraging variance components at various levels, multilevel models can reflect both item and respondent consistency, yielding a nuanced and holistic view of questionnaire reliability.</p></li>
<li><p>Controlling for systematic bias in questionnaire administration</p>
<p>Multilevel models can include potential sources of systematic bias, such as interviewer differences or geographic variation, as either fixed or random effects. This feature helps control for external factors that may influence responses, ultimately resulting in more accurate and reliable assessments of the questionnaire’s consistency.</p></li>
</ol>
<p>In practice, multilevel models can directly model questionnaire data with individual- and item-level variations, allowing researchers to differentiate between these sources of variability. This precise control over respondent- and item-specific effects makes multilevel modeling an invaluable tool in questionnaire reliability studies.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/qbgaoo\.github\.io\/r4ms");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./structural-equation.html" class="pagination-link" aria-label="Structural equation model">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Structural equation model</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./comprehensive-evaluation.html" class="pagination-link" aria-label="Comprehensive evaluation methods">
        <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Comprehensive evaluation methods</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://qbgaoo.github.io/r4ms/edit/main/multilevel-model.qmd" class="toc-action"><i class="bi bi-git"></i>Edit this page</a></li><li><a href="https://qbgaoo.github.io/r4ms/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div></div></footer><script src="site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>