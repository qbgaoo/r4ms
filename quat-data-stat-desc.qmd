# Statistical description of quantitative data

The statistical description of quantitative data involves summarizing and analyzing numerical variable to understand its distribution and characteristics. Key measures include:

-   Measures of central tendency: mean, median.
-   Measures of dispersion: range , variance, standard deviation , and interquartile range (IQR).
-   Visualization: frequency table and frequency histogram.

Together, these measures help describe the data's overall distribution, identify outliers, and inform statistical analysis in clinical and epidemiological research.

```{r}
#| echo: false

source("_common.R")
```

## Prerequisites

Setting up the required R packages.

```{r}
#| message: false

library(tidyverse)
```

## Dataset used below

In this chapter, we use the [Heart Failure Prediction Dataset](https://www.kaggle.com/fedesoriano/heart-failure-prediction) refered as `heart.csv` in the context to demonstrate the issues. The file is downloaded and saved in the `datasets` folder of this project. You can import this file into R by `read_csv()` function. The first argument is the most important: the path to the file. You can think about the path as the address of the file.

```{r}
heart <- read_csv("datasets/heart.csv")
```

The code above will work if you have the `heart.csv` file in a `datasets` folder in your project. Here is a show of some data in the file.

```{r}
heart |> 
  select(1:6)
```

Once you read data in, the first step usually involves transforming it in some way to make it easier to work with in the rest of your analysis. Firstly, we use `janitor::clean_names()` to turn all column names of `heart` into snake case. Then a variable named `max_hr` (i.e. maximum heart rate) is selected for subsequent analysis.

```{r}
max_hr <- heart |>
  janitor::clean_names() |> 
  select(max_hr, heart_disease)
  
patient_hr <- max_hr |> 
  filter(heart_disease == 1) |> 
  select(patient_hr = max_hr)

nrow(patient_hr)
```

Totally there are 508 observations. The missing values are checked below：

```{r}
patient_hr |> 
  anyNA()
```

The output `FALSE` indicates no missing values is present.

## Frequency distribution

### Frequency table

A frequency table mentioned here is a statistical tool that organizes data into intervals and lists the number of frequency in each interval. It helps summarize large dataset by showing how often each value or range of values occurs, making it easier to identify trends and the overall distribution of the data. This table is often used in conjunction with visual tools like histogram to enhance data interpretation.

Here is the steps for creating a frequency table for continuous variables.

1.  Computing the minimum and maximum of the variable.

```{r}
min_patient_hr <- patient_hr |> 
  min()

max_patient_hr <- patient_hr |> 
  max()
```

2.  Determining the number of intervals. The number of intervals is typically between 10 and 15; here, we adopt **12**. The `seq()` function is used to obtain upper and lower limits of the intervals.

```{r}
breaks <- seq(min_patient_hr, max_patient_hr, length.out = 13)
breaks
```

3.  Using the `cut()` function to dive each data into their respective intervals.

```{r}
cut(pull(patient_hr), breaks = breaks, include.lowest = T, right = F) |> 
  head(40)
```

1.  8 intervals per line, with the total number of elements being a multiple of 8. Use empty characters to pad if necessary.

```{=html}
<!-- -->
```
4.  Generating the frequency table.

```{r}
cut(pull(patient_hr), breaks = breaks, include.lowest = T, right = F) |>
  table() |> 
  knitr::kable(col.names = c("interval", "freq"), align = "c")
```

### Frequency histogram

A frequency histogram is a graphical representation of a frequency table. It displays the distribution of numerical variales by showing the frequency (count) of a value within specific intervals (bins) on the x-axis, with the y-axis representing the frequency. Each bar in the histogram corresponds to an interval, and the height of the bar indicates how many valuess fall within that range. This visual tool is useful for quickly assessing the shape, spread, and central tendency of the data distribution.

```{r}
hist(
  x              = pull(patient_hr), 
  breaks         = breaks, 
  freq           = T,
  right          = F, 
  col            = "skyblue", 
  include.lowest = T,
  main           = " ",
  xlab           = "Maximum heart rate",
  ylab           = "Frequency",
  ylim           = c(0, 120),
  labels         = T
)
```

An alternative approach to plot the same histogram is also supplied below.

```{r}
patient_hr |> 
  ggplot(aes(x = patient_hr)) +
  geom_histogram(
    fill = "skyblue", 
    stat = "bin",
    color = "black",
    breaks = breaks,
    closed = "left"
  ) +
  stat_bin(
    geom = "text", 
    aes(label = after_stat(count)),
    breaks = breaks, 
    closed = "left",
    size = 4,
    vjust = - 0.3
  ) +
  labs(x = "Maximum heart rate", y = "Frequency") +
  theme(
    axis.title.x = element_text(size = 12), 
    axis.title.y = element_text(size = 12), 
    axis.text.x = element_text(size = 11),  
    axis.text.y = element_text(size = 11),
    panel.background = element_blank(),        
    axis.line = element_line(color = "black") 
  )
```

## Measures of central tendency

Central tendency is a statistical concept that refers to the measure of the center or typical value in a data set. It provides a summary of the data with a single value that represents the middle or average of the data. The most common measures of central tendency are:

### Mean

The arithmetic average of all values. It’s calculated by summing all the values and dividing by the number of values.

For a population:

$$
\mu = \frac{\sum X_i}{N}
$$

For a sample:

$$
\bar{X} = \frac{\sum X_i}{n}
$$

where $X_i$ represents each value, and $N$ and $n$ are the sizes of the population and sample, respectively.

```{r}
patient_hr |> 
  pull() |> 
  mean()
```

### Median

The middle value in a data set when the values are sorted in ascending order. If there is an even number of values, the median is the average of the two middle values. To find the median:

-   Sort the data set.
-   If the number of observations N is odd, the median is the middle value.
-   If N is even, the median is the average of the two central values.

```{r}
patient_hr |> 
  pull() |> 
  median()
```

## Measures of dispersion

Dispersion or variability, describe the spread or dispersion of data points in a data set. They provide insight into how much individual data points differ from the central value (mean, median, etc.). Common measures of dispersion include:

### Range

The difference between the maximum and minimum values in the data set.

$$
\text{range} = \text{max} - \text{min} 
$$

```{r}
range(patient_hr) |> 
  diff()
```

### Interquartile Range (IQR)

The range of the middle 50% of the data, calculated as the difference between the 75th percentile (Q3) and the 25th percentile (Q1).

$$
\text{IQR} = Q3 - Q1 
$$

You can directly use the `IQR()` function to get IQR.

```{r}
patient_hr |> 
  pull() |> 
  IQR()
```

### Variance

Measures the average squared deviation of each data point from the mean.

For a population:

$$
\sigma^2 = \frac{1}{N} \sum_{i=1}^N (X_i - \mu)^2 
$$

For a sample:

$$
S^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \bar{X})^2 
$$

where $\mu$ is the population mean, $\bar{X}$ is the sample mean, $X_i$ represents each value, and $N$ and $n$ are are the sizes of the population and sample, respectively.

You can directly use the `var()` function to get variance.

```{r}
patient_hr |> 
  pull() |> 
  var()
```

### Standard deviation

The square root of the variance, providing a measure of spread in the same units as the data.

For a population:

$$
\sigma = \sqrt{\frac{1}{N} \sum_{i=1}^N (X_i - \mu)^2}
$$

For a sample:

$$
S = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (X_i - \bar{X})^2}
$$

You can directly use the `sd()` function to get standard deviation.

```{r}
patient_hr |> 
  pull() |> 
  sd()
```

### Coefficient of Variation (CV)

The ratio of the standard deviation to the mean, expressed as a percentage, useful for comparing variability between variables with different units or scales.

For a population:

$$
\text{CV} = \frac{\sigma}{\mu} \times 100% 
$$

where $\sigma$ is the standard deviation and $\mu$ is the mean of a population.

For a sample:

$$
\text{CV} = \frac{S}{\bar{X}} \times 100% 
$$

where $S$ is the standard deviation and $\bar{X}$ is the mean of a sample.

```{r}
mean <- patient_hr |> 
  pull() |> 
  mean()

sd <- patient_hr |> 
  pull() |> 
  sd()

sd / mean * 100
```

## Medical reference range

A medical reference range is a set of values that is used by healthcare providers to interpret laboratory test results. These ranges are typically established by testing a large group of healthy individuals and determining the normal distribution of values within that population. The reference range provides a context for understanding whether a individual’s test results fall within a normal, expected range or if they indicate a potential health issue.

```{r}
med_ref_range <- max_hr |> 
  filter(heart_disease == 0) |> 
  select(normal_hr = max_hr) |> 
  pull() |> 
  quantile(probs = c(0.025, 0.975)) |> 
  round(digits = 0) |> 
  print()
```

The result indicates that the 95% medical reference range for the maximum heart rate in normal individuals is: `r paste0("(", med_ref_range[1], ", ", med_ref_range[2], ")")`
