# Statistical description of quantitative data

In this chapter, you’ll learn how to calculate measures of central tendency and dispersion. In medical studies, they are crucial for summarizing and understanding data distributions. Central tendency provides a single value representing the center of the data, while dispersion shows how much the data varies around this central point. Together, these measures help describe the data's overall pattern, identify outliers, and inform statistical analyses in clinical and epidemiological research.

```{r}
#| echo: false

source("_common.R")
```

## Prerequisites

Setting up the required R packages.

```{r}
#| message: false

library(tidyverse)
```

## Importing the data

[Heart Failure Prediction Dataset](https://www.kaggle.com/fedesoriano/heart-failure-prediction)

**例** 从 `adsl` 数据集中筛选女性患者maximum heart rate ($kg/m^2$) 数据，结果如下：

```{r}
df <- read_csv("datasets/heart.csv", show_col_types = F)

max_hr <- df |>
  janitor::clean_names() |> 
  select(sex, max_hr, heart_disease) |> 
  filter(sex == "F", heart_disease == 1) |> 
  select(max_hr)

nrow(max_hr)
```

共有50例数据，检查是否有缺失值：

```{r}
max_hr |> 
  anyNA()
```

## Measures of central tendency

### Mean

**例2-2** 计算例2-1某医院138名正常成年女性的红细胞数的均数。

```{r}
max_hr |> 
  pull() |> 
  mean()
```

### Median

计算例2-1某医院138名正常成年女性的红细胞数的中位数和四分位数：

```{r}
max_hr |> 
  pull() |> 
  median()
```

## Measures of dispersion

以例2-1某医院138名正常成年女性的红细胞数为例，计算描述离散趋势的统计指标：

### 极差

```{r}
range(max_hr) |> 
  diff()
```

### **Quartile** and **percentile**

```{r}
max_hr |> 
  pull() |> 
  quantile(probs = c(0.25, 0.5, 0.75)) 
```

In R, you can calculate the interquartile range (IQR) of a numeric variable using the `IQR()` function. Here’s how you can do it:

```{r}
max_hr |> 
  pull() |> 
  IQR()
```

### Variance

```{r}
max_hr |> 
  pull() |> 
  var()
```

### **Standard deviation**

```{r}
max_hr |> 
  pull() |> 
  sd()
```

### 变异系数

```{r}
mean <- max_hr |> 
  pull() |> 
  mean()

sd <- max_hr |> 
  pull() |> 
  sd()

(sd / mean * 100) |> 
  round(digits = 1)
```

## Medical reference range

以例2-1某医院138名正常成年女性的红细胞数为例，确定其医学参考值范围：

```{r}
med_ref_range <- quantile(pull(max_hr), probs = c(0.025, 0.975)) |> 
  round(digits = 3) |> 
  print()
```

由上可知，正常成年女性红细胞数的95%医学参考值范围为: `r paste0("(", med_ref_range[1], ", ", med_ref_range[2], ")")`
