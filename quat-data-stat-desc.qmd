# Statistical description of quantitative data

In this chapter, you’ll learn how to calculate measures of central tendency and dispersion. In medical studies, they are crucial for summarizing and understanding data distributions. Central tendency provides a single value representing the center of the data, while dispersion shows how much the data varies around this central point. Together, these measures help describe the data's overall pattern, identify outliers, and inform statistical analyses in clinical and epidemiological research.

```{r}
#| echo: false

source("_common.R")
```

## Prerequisites

Setting up the required R packages.

```{r}
#| message: false

library(tidyverse)
```

## Importing the data

HFPD ([Heart Failure Prediction Dataset](https://www.kaggle.com/fedesoriano/heart-failure-prediction))

**例** 从 `adsl` 数据集中筛选女性患者maximum heart rate ($kg/m^2$) 数据，结果如下：

We can read this file into R using `read_csv()`. The first argument is the most important: the path to the file. You can think about the path as the address of the file: the file is called `heart.csv` and that it lives in the `datasets` folder.

```{r}
df <- read_csv("datasets/heart.csv")
```

The code above will work if you have the `heart.csv` file in a `datasets` folder in your project.

```{r}
max_hr <- df |>
  janitor::clean_names() |> 
  select(max_hr, heart_disease) |> 
  filter(heart_disease == 1) |> 
  select(max_hr)

nrow(max_hr)
```

共有508例数据，检查是否有缺失值：

```{r}
max_hr |> 
  anyNA()
```

## Measures of central tendency

### Mean

**例2-2** 计算例2-1某医院138名正常成年女性的红细胞数的均数。

```{r}
max_hr |> 
  pull() |> 
  mean() |> 
  round(digits = 1)
```

### Median

计算例2-1某医院138名正常成年女性的红细胞数的中位数和四分位数：

```{r}
max_hr |> 
  pull() |> 
  median()
```

## Measures of dispersion

以例2-1某医院138名正常成年女性的红细胞数为例，计算描述离散趋势的统计指标：

### Range

```{r}
range(max_hr) |> 
  diff()
```

### **Quartile** and **percentile**

```{r}
max_hr |> 
  pull() |> 
  quantile(probs = c(0.25, 0.5, 0.75)) 
```

In R, you can calculate the interquartile range (IQR) of a numeric variable using the `IQR()` function. Here’s how you can do it:

```{r}
max_hr |> 
  pull() |> 
  IQR()
```

### Variance

```{r}
max_hr |> 
  pull() |> 
  var()
```

### **Standard deviation**

```{r}
max_hr |> 
  pull() |> 
  sd()
```

### 变异系数

```{r}
mean <- max_hr |> 
  pull() |> 
  mean()

sd <- max_hr |> 
  pull() |> 
  sd()

(sd / mean * 100) |> 
  round(digits = 1)
```

## Medical reference range

以例2-1某医院138名正常成年女性的红细胞数为例，确定其医学参考值范围：

```{r}
med_ref_range <- quantile(pull(max_hr), probs = c(0.025, 0.975)) |> 
  round(digits = 3) |> 
  print()
```

由上可知，正常成年女性红细胞数的95%医学参考值范围为: `r paste0("(", med_ref_range[1], ", ", med_ref_range[2], ")")`
